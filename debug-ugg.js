var response
var ffile
var reader
var gparsed
var based64
var imgEle
var elemVar

var dxfString
var svgString
var svgEle

// too lazy for full dxf codepath

async function fetchAsync (url,elem,type) {
		console.log('url:'+url)
	response = await fetch(url);
		console.log('response status:'+response.status)
	ffile = await response.blob();
		console.log('file object type:'+ffile.type)
	reader = new FileReader();
	reader.onloadend = function () {
			console.log('fileReader.result (first line):'+reader.result.split('\n')[0])
		if(type==="tap"){
		gparsed = gcodetogeometry.parse(reader.result)
			console.log("gcode size:x:"+gparsed.size.max.x+"y:"+gparsed.size.max.x)
		based64 = getBase64(gparsed.gcode.join('\n'),{G1:'#001122',G2G3:"#001122"},gparsed.size.max.x*10,gparsed.size.max.y*10)
			console.log("base64 header:"+based64.split(',')[0])
		imgEle= document.createElement('img')
		imgEle.src= based64
			console.log(imgEle)
		console.log(elem)
		elemVar= elem
		elem.appendChild(imgEle)
		}
		if(type==="dxf"){
			dxfString= dxf.parseString(reader.result)
		console.log(dxfString)
			svgString= dxf.toSVG(dxfString).slice(22)
		console.log(svgString)
			svgEle=	new window.DOMParser().parseFromString(svgString, "text/xml").documentElement
			svgEle.setAttribute('class','dxf')
		console.log(svgEle)
		console.log(elem)
		elemVar= elem
			elem.appendChild(svgEle)
		}
	}
	if (ffile) {reader.readAsText(ffile)}
}

window.addEventListener("contextmenu", function(e){
	if(e.ctrlKey && e.button ==2){
		if(e.target.href.toLowerCase().includes('.dxf')){
			fetchAsync(e.target.href, e.target,'dxf')	
		}
		if(e.target.href.toLowerCase().includes('.tap')){
			fetchAsync(e.target.href, e.target,'tap')	
		}
	};
});

var mainStyle = document.createElement('style');
mainStyle.textContent = `
	svg.dxf {
		max-width:100px;
		max-height:100px;
	}
	path {
		stroke-width:2%;
	}
	img.gcode {
		max-width:100px;
		max-height:100px;
	}
	`
document.body.appendChild(mainStyle)

//place these here for 1 copy paste in console
function preview(e,t,n){function i(e,t){var n=Math.abs(e.size.max.x-e.size.min.x);var i=Math.abs(e.size.max.y-e.size.min.y);var a=parseInt(t.width,10),r=parseInt(t.height,10);return Math.min(a/n,r/i)}function a(e,t,n,i,a,r){var s=Math.round(t*(i.start.x-n.x));var o=Math.round(a-t*(i.start.y-n.y));var h=Math.round(t*(i.end.x-n.x));var v=Math.round(a-t*(i.end.y-n.y));e.beginPath();e.moveTo(s,o);e.lineTo(h,v);e.strokeStyle=r;e.lineWidth=2;e.stroke();e.closePath()}function r(e,t,n,i,a,r){var s=0;var o=i.beziers,h={};e.beginPath();for(s=0;s<o.length;s++){h=o[s];e.moveTo(t*(h.p0.x-n.x),a-t*(h.p0.y-n.y));e.bezierCurveTo(t*(h.p1.x-n.x),a-t*(h.p1.y-n.y),t*(h.p2.x-n.x),a-t*(h.p2.y-n.y),t*(h.p3.x-n.x),a-t*(h.p3.y-n.y))}e.strokeStyle=r;e.lineWidth=2;e.stroke();e.closePath()}if(t===undefined){return}var s=gcodetogeometry.parse(e);if(s.size.max.x===s.size.min.x&&s.size.max.y===s.size.min.y){return}var o={x:s.size.min.x,y:s.size.min.y};var h=0,v=i(s,n);var y=parseInt(n.height,10);var u=n.getContext("2d");u.clearRect(0,0,n.width,n.height);u.beginPath();u.rect(0,0,n.width,n.height);u.fillStyle="white";u.fill();s.lines.map(function(e){if(e.type==="G0"&&t.G0!==undefined){a(u,v,o,e,y,t.G0)}else if(e.type==="G1"&&t.G1!==undefined){a(u,v,o,e,y,t.G1)}else if((e.type==="G2"||e.type==="G3")&&t.G2G3!==undefined){r(u,v,o,e,y,t.G2G3)}})}function getCanvas(e,t,n,i){var a=document.createElement("canvas");a.width=n;a.height=i;preview(e,t,a);return a}function getBase64(e,t,n,i){var a=getCanvas(e,t,n,i);return a.toDataURL("img/png")}function getBase64Jpeg80(e,t,n,i){var a=getCanvas(e,t,n,i);return a.toDataURL("img/jpeg",80)}

!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.gcodetogeometry=b():a.gcodetogeometry=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){var d=c(1),e=c(2).StraightLine,f=c(2).CurvedLine,g=c(3).GParser,h=function(a){"use strict";function b(a){var b=a.split("(")[0].split(";")[0];return b.split(/\s/).join("").trim()}function c(a){var b={},c=0,d="",e="",f=[],g=!0;for(c=0;c<a.words.length;c++)d=a.words[c][0],e=a.words[c][1],"G"===d||"M"===d?(g===!1&&(f.push(b),b={}),b.type=d+e,g=!1):b[d.toLowerCase()]=parseFloat(e,10);return f.push(b),f}function h(a,b){var c=0,d=0,e=!0;for(d=b.length-1;d>=0;d--){for(c=a.length-1;c>=0;c--)if(e=!1,b[d].toUpperCase()===a[c].toUpperCase()){e=!0,a.splice(c,1);break}if(e===!1)return!0}return!1}function i(a,b){var c=["x","y","z"],d=0;for(d=c.length-1;d>=0;d--)a.min[c[d]]>b.min[c[d]]&&(a.min[c[d]]=b.min[c[d]]),a.max[c[d]]<b.max[c[d]]&&(a.max[c[d]]=b.max[c[d]])}function j(a,b,c){return{line:a,message:b,isSkipped:c}}function k(a,b,c,d){var e=a,f=void 0===e.f?d.feedrate:e.f;return void 0!==e.type&&"G1"!==e.type&&"G2"!==e.type&&"G3"!==e.type?!1:f>0?!1:0>f?(b.push(j(c,"(warning) Cannot use a negative feed rate (the absolute value is used).",!1)),e.f=Math.abs(f),!1):(b.push(j(c,"(error) Cannot use a null feed rate (skipped).",!0)),d.feedrate=0,!0)}function l(a,b){void 0===a.type&&""!==b&&(a.type=b)}function m(a,b,c,e){var f={x:a.x,y:a.y,z:a.z},g=e===!1?1:d.MILLIMETER_TO_INCH;return c===!0?(void 0!==b.x&&(f.x+=b.x*g),void 0!==b.y&&(f.y+=b.y*g),void 0!==b.z&&(f.z+=b.z*g)):(void 0!==b.x&&(f.x=b.x*g),void 0!==b.y&&(f.y=b.y*g),void 0!==b.z&&(f.z=b.z*g)),f}function n(a,b,c){var d=["X","Y","Z"],e=Object.keys(a);return e.splice(e.indexOf("type"),1),h(d,e)===!0&&b.push(j(c,"(warning) Some parameters are wrong.",!1)),!0}function o(a,b,c,d){var e=["X","Y","Z","F"],f=Object.keys(a);return f.splice(f.indexOf("type"),1),h(e,f)===!0&&b.push(j(c,"(warning) Some parameters are wrong.",!1)),!k(a,b,c,d)}function p(a,b,c,d){var e=["X","Y","Z","F","I","J","K","R"],f=Object.keys(a);return f.splice(f.indexOf("type"),1),h(e,f)===!0&&b.push(j(c,"(warning) Some parameters are wrong.",!1)),void 0===a.r&&void 0===a.i&&void 0===a.j&&void 0===a.k?(b.push(j(c,"(error) No parameter R, I, J or K.",!0)),!1):void 0===a.r||void 0===a.i&&void 0===a.j&&void 0===a.k?!k(a,b,c,d):(b.push(j(c,"(error) Cannot use R and I, J or K at the same time.",!0)),!1)}function q(a,b,c,f,g){var h=m(b.position,a,b.relative,b.inMm),j=new e(c,b.position,h,a,b);b.previousMoveCommand=a.type,i(g,j.getSize()),f.push(j.returnLine()),b.position=d.copyObject(j.end),void 0!==a.f&&(b.feedrate=a.f)}function r(a,b,c,e,g,h){var k=m(b.position,a,b.relative,b.inMm),l=new f(c,b.position,k,a,b);if(l.center!==!1){var n=l.returnLine();if(n===!1)return void h.push(j(c,"(error) Impossible to create arc.",!0));b.feedrate=l.feedrate,b.previousMoveCommand=a.type,i(g,l.getSize()),e.push(n),b.position=d.copyObject(l.end)}else h.push(j(c,"(error) Physically impossible to do with those values.",!0))}function s(a,b,c,d,e,f){if(void 0===a.type&&0===Object.keys(a).length)return!0;if(l(a,b.previousMoveCommand),void 0===a.type)void 0!==a.f&&(k(a,f,c,b.feedrate),b.feedrate=a.f);else if("G0"===a.type&&n(a,f,c)===!0)q(a,b,c,d,e);else if("G1"===a.type&&o(a,f,c,b)===!0)q(a,b,c,d,e);else if("G2"!==a.type&&"G3"!==a.type||p(a,f,c,b)!==!0){if("G17"===a.type)b.crossAxe="z";else if("G18"===a.type)b.crossAxe="y";else if("G19"===a.type)b.crossAxe="x";else if("G20"===a.type)b.inMm=!1,t===!1&&(u=!0,t=!0);else if("G21"===a.type)b.inMm=!0,t===!1&&(u=!1,t=!0);else if("G90"===a.type)b.relative=!1;else if("G91"===a.type)b.relative=!0;else if("M2"===a.type)return!1}else r(a,b,c,d,e,f);return!0}var t=!1,u=!0,v={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}},w=0,x=0,y=[],z=!0,A=[],B=[],C={feedrate:0,previousMoveCommand:"",crossAxe:"z",inMm:!1,relative:!1,position:{x:0,y:0,z:0}};if("string"!=typeof a||""===a)return{gcode:[],lines:[],size:v,displayInInch:u,errorList:[{line:0,message:"(error) No command."}]};var D=a.split("\n");for(w=0;w<D.length&&z===!0;){for(y=c(g.parse(b(D[w]).toUpperCase())),x=0;x<y.length&&z===!0;)z=s(y[x],C,w+1,A,v,B),x++;w++}return w<D.length&&B.push(j(w+1,"(warning) The next code is not executed.",!1)),{gcode:D,lines:A,size:v,displayInInch:u,errorList:B}};b.parse=h},function(a,b){"use strict";var c={};c.INCH_TO_MILLIMETER=25.4,c.MILLIMETER_TO_INCH=.03937008,c.FLOAT_PRECISION=.001,c.calculateFeedrate=function(a,b){return b===!1?a:a*c.MILLIMETER_TO_INCH},c.nearlyEqual=function(a,b,d){var e=void 0===d?c.FLOAT_PRECISION:d;return Math.abs(b-a)<=e},c.swapObjects=function(a,b){function d(a,b,c){var d;d=a[c],a[c]=b[c],b[c]=d}var e=Object.keys(a),f=0;for(f=0;f<e.length;f++)"object"==typeof a[e[f]]?c.swapObjects(a[e[f]],b[e[f]]):d(a,b,e[f])},c.copyObject=function(a){var b=Object.keys(a),d=0,e={};for(d=0;d<b.length;d++)"object"==typeof a[b[d]]?e[b[d]]=c.copyObject(a[b[d]]):e[b[d]]=a[b[d]];return e},c.movePoint=function(a,b){var c=Object.keys(b),d=0;for(d=0;d<c.length;d++)void 0!==a[c[d]]&&(a[c[d]]+=b[c[d]])},c.dotProduct2=function(a,b){return a.x*b.x+a.y*b.y},c.crossProduct2=function(a,b){return a.x*b.y-b.x*a.y},c.lengthVector3=function(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)},c.findAxes=function(a){return"x"===a.toLowerCase()?{re:"y",im:"z",cr:"x"}:"y"===a.toLowerCase()?{re:"z",im:"x",cr:"y"}:{re:"x",im:"y",cr:"z"}},c.scaleAndRotation=function(a,b,c,d,e,f,g){var h=a,i=b,j=c,k=e,l=Math.cos(d),m=Math.sin(d),n=i[f],o=i[g],p=h[f],q=h[g];j[f]=k*((n-p)*l-(o-q)*m)+p,j[g]=k*((o-q)*l+(n-p)*m)+q},c.findAngleVectors2=function(a,b){var d=c.crossProduct2(a,b)<0?-1:1,e=c.dotProduct2(a,b),f=Math.sqrt(a.x*a.x+a.y*a.y),g=Math.sqrt(b.x*b.x+b.y*b.y);return 0===f||0===g?0:d*Math.acos(e/(f*g))},c.findAngleOrientedVectors2=function(a,b,d){var e=c.findAngleVectors2(a,b);return d===!1&&e>0?e-2*Math.PI:d===!0&&0>e?2*Math.PI+e:e},c.isInclude=function(a,b,c){return b>c?a>=c&&b>=a:a>=b&&c>=a};var d=Object.keys(c),e=0;for(e=0;e<d.length;e++)b[d[e]]=c[d[e]]},function(a,b,c){var d=c(1),e=function(a,b,c,e,f){"use strict";function g(a,b,e,f){h.index=a,h.word=e.type,h.start={x:b.x,y:b.y,z:b.z},h.end=c,"G0"===e.type?h.feedrate=0:void 0===e.f?h.feedrate=f.feedrate:h.feedrate=d.calculateFeedrate(e.f,f.inMm)}var h=this;h.returnLine=function(){return{lineNumber:h.index,type:h.word,start:h.start,end:h.end,feedrate:h.feedrate}},h.getSize=function(){return{min:{x:Math.min(h.start.x,h.end.x),y:Math.min(h.start.y,h.end.y),z:Math.min(h.start.z,h.end.z)},max:{x:Math.max(h.start.x,h.end.x),y:Math.max(h.start.y,h.end.y),z:Math.max(h.start.z,h.end.z)}}},g(a,b,e,f)},f=function(a,b,c,e,f){"use strict";function g(){var a=d.findAxes(s.crossAxe),b={x:s.start[a.re]-s.center[a.re],y:s.start[a.im]-s.center[a.im],z:0},c={x:s.end[a.re]-s.center[a.re],y:s.end[a.im]-s.center[a.im],z:0};return d.findAngleOrientedVectors2(b,c,s.clockwise===!1)}function h(){var a=d.findAxes(s.crossAxe),b={x:s.start[a.re]-s.center[a.re],y:s.start[a.im]-s.center[a.im],z:0};return d.lengthVector3(b)}function i(a,b){var c={},d={},e={},f={};return a=Math.abs(a),a===Math.PI/2?(c={x:.707106781186548,y:.707106781186548,z:0},d={x:1.097631072937817,y:.316582489435277,z:0}):(c={x:Math.cos(a/2),y:Math.sin(a/2),z:0},d={x:(4-c.x)/3,y:(1-c.x)*(3-c.x)/(3*c.y),z:0}),c.x*=b,c.y*=b,d.x*=b,d.y*=b,e={x:d.x,y:-d.y,z:0},f={x:c.x,y:-c.y,z:0},{p0:c,p1:d,p2:e,p3:f}}function j(a,b,c,e){var f=0;return b===!1&&(d.swapObjects(a.p0,a.p3),d.swapObjects(a.p1,a.p2)),f=c/3,"z"===e.toLowerCase()?(a.p0.z=0,a.p1.z=f,a.p2.z=2*f,a.p3.z=3*f):"x"===e.toLowerCase()?(a.p0.z=a.p0.y,a.p0.y=a.p0.x,a.p0.x=0,a.p1.z=a.p1.y,a.p1.y=a.p1.x,a.p1.x=f,a.p2.z=a.p2.y,a.p2.y=a.p2.x,a.p2.x=2*f,a.p3.z=a.p3.y,a.p3.y=a.p3.x,a.p3.x=3*f):"y"===e.toLowerCase()&&(a.p0.z=a.p0.x,a.p0.x=a.p0.y,a.p0.y=0,a.p1.z=a.p1.x,a.p1.x=a.p1.y,a.p1.y=f,a.p2.z=a.p2.x,a.p2.x=a.p2.y,a.p2.y=2*f,a.p3.z=a.p3.x,a.p3.x=a.p3.y,a.p3.y=3*f),a}function k(a,b,c,e,f){var g={x:0,y:0,z:0};d.scaleAndRotation(g,a.p0,a.p0,c,1,e,f),d.scaleAndRotation(g,a.p1,a.p1,c,1,e,f),d.scaleAndRotation(g,a.p2,a.p2,c,1,e,f),d.scaleAndRotation(g,a.p3,a.p3,c,1,e,f),d.movePoint(a.p0,b),d.movePoint(a.p1,b),d.movePoint(a.p2,b),d.movePoint(a.p3,b)}function l(a,b,c,e,f){var g=[],h=d.copyObject(s.center),i=d.findAxes(s.crossAxe),j={x:s.start[i.re]-h[i.re],y:s.start[i.im]-h[i.im]},l=0,m=0,n=s.clockwise===!0?-1:1;if(0===a&&0===c)return g;if(a>0)for(m=d.findAngleOrientedVectors2({x:b.p0[i.re],y:b.p0[i.im]},j,s.clockwise===!1),l=0;a>l;l++)g.push(d.copyObject(b)),k(g[l],h,m,i.re,i.im),m+=1.570796326794897*n,h[s.crossAxe]+=f;return c>0&&(m=d.findAngleOrientedVectors2({x:e.p0[i.re],y:e.p0[i.im]},j,s.clockwise===!1),0!==a&&(m+=1.570796326794897*a*n),g.push(d.copyObject(e)),k(g[l],h,m,i.re,i.im)),g[0].p0.x=s.start.x,g[0].p0.y=s.start.y,g[0].p0.z=s.start.z,g[g.length-1].p3.x=s.end.x,g[g.length-1].p3.y=s.end.y,g[g.length-1].p3.z=s.end.z,g}function m(){var a=0,b=1,c={},d={},e=0,f=0,k=0,m=g(),n=h(),o=Math.abs(m),p=1.570796326794897;return 0===m||0===n?[]:(o>p&&(a=parseInt(o/p,10),b=o%p!==0?1:0),k=(s.end[s.crossAxe]-s.start[s.crossAxe])/o,e=p*k,f=(o-a*p)*k,a>0&&(c=i(p,n),j(c,0>m,e,s.crossAxe)),b>0&&(m=o-a*p,s.clockwise===!0&&(m=-m),d=i(m,n),j(d,0>m,f,s.crossAxe)),l(a,c,b,d,e))}function n(){var a={},b=[],c=0,e=1.570796326794897,f=s.clockwise===!0?-1:1,g=f*Math.PI*2,m=h(),n=0,o=d.copyObject(s.center),p=d.findAxes(s.crossAxe);if(0===m)return[];for(c=(s.end[s.crossAxe]-s.start[s.crossAxe])/4,a=i(e,m),j(a,s.clockwise,c,s.crossAxe),n=0;4>n;n++)b.push(d.copyObject(a)),k(b[n],o,g,p.re,p.im),g+=e*f,o[s.crossAxe]+=c;return l(4,a,0,a,c)}function o(a,b,c,e,f){var g={x:b.x-a.x,y:b.y-a.y,z:b.z-a.z},h=0,i=1,j=0,k=Math.abs(c),l=0,m={x:0,y:0,z:0},n=d.findAxes(f);if(j=Math.sqrt(g[n.re]*g[n.re]+g[n.im]*g[n.im]),j>Math.abs(2*c)||0===j)return!1;if(h=Math.acos(j/(2*k)),i=k/j,d.scaleAndRotation(a,b,m,h,i,n.re,n.im),l=d.findAngleVectors2({x:a[n.re]-m[n.re],y:a[n.im]-m[n.im]},{x:b[n.re]-m[n.re],y:b[n.im]-m[n.im]}),e===!0){if(c>0&&-Math.PI<=l&&0>=l)return m;if(0>c&&l>=0&&l<=Math.PI)return m}else{if(c>0&&l>=0&&l<=Math.PI)return m;if(0>c&&-Math.PI<=l&&0>=l)return m}return d.scaleAndRotation(a,b,m,-h,i,n.re,n.im),m}function p(a,b,c,e,f,g){var h,i,j=g===!1?1:d.MILLIMETER_TO_INCH,k={x:a.x,y:a.y,z:a.z},l=d.findAxes(f);if(void 0===c.r){if(void 0!==c.i&&(k.x+=c.i*j),void 0!==c.j&&(k.y+=c.j*j),void 0!==c.k&&(k.z+=c.k*j),h=Math.pow(k[l.re]-a[l.re],2),h+=Math.pow(k[l.im]-a[l.im],2),i=Math.pow(k[l.re]-b[l.re],2),i+=Math.pow(k[l.im]-b[l.im],2),d.nearlyEqual(h,0)===!0||d.nearlyEqual(i,0)===!0)return!1;if(d.nearlyEqual(h,i)===!1)return!1}else if(k=o(a,b,c.r*j,e,f),k===!1)return!1;return k[f]=a[f],k}function q(a,b,c,e){var f=d.findAngleOrientedVectors2(e,{x:a,y:b},s.clockwise===!1);return d.isInclude(f,0,c)===!0}function r(a,b,e,f){s.index=a,s.word=e.type,s.start={x:b.x,y:b.y,z:b.z},s.end=c,s.clockwise="G2"===e.type,s.center=p(b,s.end,e,s.clockwise,f.crossAxe,f.inMm),s.crossAxe=f.crossAxe,void 0===e.f?s.feedrate=f.feedrate:s.feedrate=d.calculateFeedrate(e.f,f.inMm)}var s=this;s.returnLine=function(){var a=[],b=d.findAxes(s.crossAxe);return a=s.start[b.re]===s.end[b.re]&&s.start[b.im]===s.end[b.im]?n():m(),0===a.length?!1:{lineNumber:s.index,type:s.word,beziers:a,feedrate:s.feedrate}},s.getSize=function(){var a=d.findAxes(s.crossAxe),b={x:s.start[a.re]-s.center[a.re],y:s.start[a.im]-s.center[a.im]},c=h(),e=g(),f={x:0,y:0,z:0},i={x:0,y:0,z:0};return s.start[a.re]===s.end[a.re]&&s.start[a.im]===s.end[a.im]?(f[a.re]=s.center[a.re]-c,f[a.im]=s.center[a.im]-c,f[a.cr]=Math.min(s.start[a.cr],s.end[a.cr]),i[a.re]=s.center[a.re]+c,i[a.im]=s.center[a.im]+c,i[a.cr]=Math.max(s.start[a.cr],s.end[a.cr]),{min:f,max:i}):(f.x=Math.min(s.start.x,s.end.x),f.y=Math.min(s.start.y,s.end.y),f.z=Math.min(s.start.z,s.end.z),i.x=Math.max(s.start.x,s.end.x),i.y=Math.max(s.start.y,s.end.y),i.z=Math.max(s.start.z,s.end.z),q(0,1,e,b)===!0&&(i[a.im]=s.center[a.im]+c),q(0,-1,e,b)===!0&&(f[a.im]=s.center[a.im]-c),q(1,0,e,b)===!0&&(i[a.re]=s.center[a.re]+c),q(-1,0,e,b)===!0&&(f[a.re]=s.center[a.re]-c),{min:f,max:i})},r(a,b,e,f)};b.StraightLine=e,b.CurvedLine=f},function(a,b){var c=function(){function a(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function b(a,b,c,d,e,f){this.message=a,this.expected=b,this.found=c,this.offset=d,this.line=e,this.column=f,this.name="SyntaxError"}function c(a){function c(){return a.substring(Jb,Ib)}function d(b){function c(b,c,d){var e,f;for(e=c;d>e;e++)f=a.charAt(e),"\n"===f?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1)}return Kb!==b&&(Kb>b&&(Kb=0,Lb={line:1,column:1,seenCR:!1}),c(Lb,Kb,b),Kb=b),Lb}function e(a){Mb>Ib||(Ib>Mb&&(Mb=Ib,Nb=[]),Nb.push(a))}function f(c,e,f){function g(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d,e,f,g=new Array(a.length);for(f=0;f<a.length;f++)g[f]=a[f].description;return d=a.length>1?g.slice(0,-1).join(", ")+" or "+g[a.length-1]:g[0],e=b?'"'+c(b)+'"':"end of input","Expected "+d+" but "+e+" found."}var i=d(f),j=f<a.length?a.charAt(f):null;return null!==e&&g(e),new b(null!==c?c:h(e,j),e,j,f,i.line,i.column)}function g(){var a;return a=h()}function h(){var a,b,c,d;if(a=Ib,b=j(),b===B&&(b=F),b!==B){for(c=[],d=i();d!==B;)c.push(d),d=i();c!==B?(Jb=a,b=G(b,c),a=b):(Ib=a,a=E)}else Ib=a,a=E;return a}function i(){var a,b,c;return a=Ib,b=y(),b!==B?(c=q(),c!==B?(Jb=a,b=H(b,c),a=b):(Ib=a,a=E)):(Ib=a,a=E),a}function j(){var b,c,d;return b=Ib,78===a.charCodeAt(Ib)?(c=I,Ib++):(c=B,0===Ob&&e(J)),c!==B?(d=k(),d!==B?(c=[c,d],b=c):(Ib=b,b=E)):(Ib=b,b=E),b}function k(){var b,c,d;if(b=Ib,c=[],K.test(a.charAt(Ib))?(d=a.charAt(Ib),Ib++):(d=B,0===Ob&&e(L)),d!==B)for(;d!==B;)c.push(d),K.test(a.charAt(Ib))?(d=a.charAt(Ib),Ib++):(d=B,0===Ob&&e(L));else c=E;return c!==B&&(Jb=b,c=M()),b=c}function l(){var b,c,d,f,g,h,i;if(b=Ib,N.test(a.charAt(Ib))?(c=a.charAt(Ib),Ib++):(c=B,0===Ob&&e(O)),c===B&&(c=F),c!==B){if(d=[],K.test(a.charAt(Ib))?(f=a.charAt(Ib),Ib++):(f=B,0===Ob&&e(L)),f!==B)for(;f!==B;)d.push(f),K.test(a.charAt(Ib))?(f=a.charAt(Ib),Ib++):(f=B,0===Ob&&e(L));else d=E;if(d!==B){if(f=Ib,P.test(a.charAt(Ib))?(g=a.charAt(Ib),Ib++):(g=B,0===Ob&&e(Q)),g!==B){if(h=[],K.test(a.charAt(Ib))?(i=a.charAt(Ib),Ib++):(i=B,0===Ob&&e(L)),i!==B)for(;i!==B;)h.push(i),K.test(a.charAt(Ib))?(i=a.charAt(Ib),Ib++):(i=B,0===Ob&&e(L));else h=E;h!==B?(g=[g,h],f=g):(Ib=f,f=E)}else Ib=f,f=E;f===B&&(f=F),f!==B?(Jb=b,c=R(),b=c):(Ib=b,b=E)}else Ib=b,b=E}else Ib=b,b=E;return b}function m(){var b,c,d,f;return b=Ib,91===a.charCodeAt(Ib)?(c=S,Ib++):(c=B,0===Ob&&e(T)),c!==B?(d=t(),d!==B?(93===a.charCodeAt(Ib)?(f=U,Ib++):(f=B,0===Ob&&e(V)),f!==B?(Jb=b,c=W(d),b=c):(Ib=b,b=E)):(Ib=b,b=E)):(Ib=b,b=E),b}function n(){var b,c,d,f,g;return b=Ib,a.substr(Ib,4)===X?(c=X,Ib+=4):(c=B,0===Ob&&e(Y)),c!==B?(d=m(),d!==B?(47===a.charCodeAt(Ib)?(f=Z,Ib++):(f=B,0===Ob&&e($)),f!==B?(g=m(),g!==B?(Jb=b,c=_(d,g),b=c):(Ib=b,b=E)):(Ib=b,b=E)):(Ib=b,b=E)):(Ib=b,b=E),b}function o(){var a,b,c;return a=Ib,b=x(),b!==B?(c=m(),c!==B?(Jb=a,b=aa(b,c),a=b):(Ib=a,a=E)):(Ib=a,a=E),a}function p(){var b,c,d;return b=Ib,35===a.charCodeAt(Ib)?(c=ba,Ib++):(c=B,0===Ob&&e(ca)),c!==B?(d=m(),d===B&&(d=l(),d===B&&(d=p())),d!==B?(Jb=b,c=da(d),b=c):(Ib=b,b=E)):(Ib=b,b=E),b}function q(){var a;return a=m(),a===B&&(a=l(),a===B&&(a=n(),a===B&&(a=o(),a===B&&(a=p())))),a}function r(){var a,b,c,d,e,f;if(a=Ib,b=q(),b!==B){for(c=[],d=Ib,e=u(),e!==B?(f=q(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);d!==B;)c.push(d),d=Ib,e=u(),e!==B?(f=q(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);c!==B?(Jb=a,b=ea(b,c),a=b):(Ib=a,a=E)}else Ib=a,a=E;return a}function s(){var a,b,c,d,e,f;if(a=Ib,b=r(),b!==B){for(c=[],d=Ib,e=v(),e!==B?(f=r(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);d!==B;)c.push(d),d=Ib,e=v(),e!==B?(f=r(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);c!==B?(Jb=a,b=fa(b,c),a=b):(Ib=a,a=E)}else Ib=a,a=E;return a}function t(){var a,b,c,d,e,f;if(a=Ib,b=s(),b!==B){for(c=[],d=Ib,e=w(),e!==B?(f=s(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);d!==B;)c.push(d),d=Ib,e=w(),e!==B?(f=s(),f!==B?(e=[e,f],d=e):(Ib=d,d=E)):(Ib=d,d=E);c!==B?(Jb=a,b=fa(b,c),a=b):(Ib=a,a=E)}else Ib=a,a=E;return a}function u(){var b;return a.substr(Ib,2)===ga?(b=ga,Ib+=2):(b=B,0===Ob&&e(ha)),b}function v(){var b;return 42===a.charCodeAt(Ib)?(b=ia,Ib++):(b=B,0===Ob&&e(ja)),b===B&&(47===a.charCodeAt(Ib)?(b=Z,Ib++):(b=B,0===Ob&&e($)),b===B&&(a.substr(Ib,3)===ka?(b=ka,Ib+=3):(b=B,0===Ob&&e(la)))),b}function w(){var b;return 43===a.charCodeAt(Ib)?(b=ma,Ib++):(b=B,0===Ob&&e(na)),b===B&&(45===a.charCodeAt(Ib)?(b=oa,Ib++):(b=B,0===Ob&&e(pa)),b===B&&(a.substr(Ib,2)===qa?(b=qa,Ib+=2):(b=B,0===Ob&&e(ra)),b===B&&(a.substr(Ib,3)===sa?(b=sa,Ib+=3):(b=B,0===Ob&&e(ta)),b===B&&(a.substr(Ib,3)===ua?(b=ua,Ib+=3):(b=B,0===Ob&&e(va)))))),b}function x(){var b;return a.substr(Ib,3)===wa?(b=wa,Ib+=3):(b=B,0===Ob&&e(xa)),b===B&&(a.substr(Ib,4)===ya?(b=ya,Ib+=4):(b=B,0===Ob&&e(za)),b===B&&(a.substr(Ib,4)===Aa?(b=Aa,Ib+=4):(b=B,0===Ob&&e(Ba)),b===B&&(a.substr(Ib,3)===Ca?(b=Ca,Ib+=3):(b=B,0===Ob&&e(Da)),b===B&&(a.substr(Ib,3)===Ea?(b=Ea,Ib+=3):(b=B,0===Ob&&e(Fa)),b===B&&(a.substr(Ib,3)===Ga?(b=Ga,Ib+=3):(b=B,0===Ob&&e(Ha)),b===B&&(a.substr(Ib,3)===Ia?(b=Ia,Ib+=3):(b=B,0===Ob&&e(Ja)),b===B&&(a.substr(Ib,5)===Ka?(b=Ka,Ib+=5):(b=B,0===Ob&&e(La)),b===B&&(a.substr(Ib,2)===Ma?(b=Ma,Ib+=2):(b=B,0===Ob&&e(Na)),b===B&&(a.substr(Ib,3)===Oa?(b=Oa,Ib+=3):(b=B,0===Ob&&e(Pa)),b===B&&(a.substr(Ib,4)===Qa?(b=Qa,Ib+=4):(b=B,0===Ob&&e(Ra)),b===B&&(a.substr(Ib,3)===Sa?(b=Sa,Ib+=3):(b=B,0===Ob&&e(Ta)),b===B&&(a.substr(Ib,6)===Ua?(b=Ua,Ib+=6):(b=B,0===Ob&&e(Va)))))))))))))),b}function y(){var b;return 65===a.charCodeAt(Ib)?(b=Wa,Ib++):(b=B,0===Ob&&e(Xa)),b===B&&(66===a.charCodeAt(Ib)?(b=Ya,Ib++):(b=B,0===Ob&&e(Za)),b===B&&(67===a.charCodeAt(Ib)?(b=$a,Ib++):(b=B,0===Ob&&e(_a)),b===B&&(68===a.charCodeAt(Ib)?(b=ab,Ib++):(b=B,0===Ob&&e(bb)),b===B&&(70===a.charCodeAt(Ib)?(b=cb,Ib++):(b=B,0===Ob&&e(db)),b===B&&(71===a.charCodeAt(Ib)?(b=eb,Ib++):(b=B,0===Ob&&e(fb)),b===B&&(72===a.charCodeAt(Ib)?(b=gb,Ib++):(b=B,0===Ob&&e(hb)),b===B&&(73===a.charCodeAt(Ib)?(b=ib,Ib++):(b=B,0===Ob&&e(jb)),b===B&&(74===a.charCodeAt(Ib)?(b=kb,Ib++):(b=B,0===Ob&&e(lb)),b===B&&(75===a.charCodeAt(Ib)?(b=mb,Ib++):(b=B,0===Ob&&e(nb)),b===B&&(76===a.charCodeAt(Ib)?(b=ob,Ib++):(b=B,0===Ob&&e(pb)),b===B&&(77===a.charCodeAt(Ib)?(b=qb,Ib++):(b=B,0===Ob&&e(rb)),b===B&&(80===a.charCodeAt(Ib)?(b=sb,Ib++):(b=B,0===Ob&&e(tb)),b===B&&(81===a.charCodeAt(Ib)?(b=ub,Ib++):(b=B,0===Ob&&e(vb)),b===B&&(82===a.charCodeAt(Ib)?(b=wb,Ib++):(b=B,0===Ob&&e(xb)),b===B&&(83===a.charCodeAt(Ib)?(b=yb,Ib++):(b=B,0===Ob&&e(zb)),b===B&&(84===a.charCodeAt(Ib)?(b=Ab,Ib++):(b=B,0===Ob&&e(Bb)),b===B&&(88===a.charCodeAt(Ib)?(b=Cb,Ib++):(b=B,0===Ob&&e(Db)),b===B&&(89===a.charCodeAt(Ib)?(b=Eb,Ib++):(b=B,0===Ob&&e(Fb)),b===B&&(90===a.charCodeAt(Ib)?(b=Gb,Ib++):(b=B,0===Ob&&e(Hb))))))))))))))))))))),b}var z,A=arguments.length>1?arguments[1]:{},B={},C={start:g},D=g,E=B,F=null,G=function(a,b){return{N:a,words:b}},H=function(a,b){return[a,b]},I="N",J={type:"literal",value:"N",description:'"N"'},K=/^[0-9]/,L={type:"class",value:"[0-9]",description:"[0-9]"},M=function(){return parseInt(c())},N=/^[+\-]/,O={type:"class",value:"[+\\-]",description:"[+\\-]"},P=/^[.]/,Q={type:"class",value:"[.]",description:"[.]"},R=function(){return parseFloat(c())},S="[",T={type:"literal",value:"[",description:'"["'},U="]",V={type:"literal",value:"]",description:'"]"'},W=function(a){return a},X="ATAN",Y={type:"literal",value:"ATAN",description:'"ATAN"'},Z="/",$={type:"literal",value:"/",description:'"/"'},_=function(a,b){return{op:"ATAN",left:a,right:b}},aa=function(a,b){return{op:a,right:b}},ba="#",ca={type:"literal",value:"#",description:'"#"'},da=function(a){return{op:"#",right:a}},ea=function(a,b){return buildTree(a,b)},fa=function(a,b){return buildTree(a,b)},ga="**",ha={type:"literal",value:"**",description:'"**"'},ia="*",ja={type:"literal",value:"*",description:'"*"'},ka="MOD",la={type:"literal",value:"MOD",description:'"MOD"'},ma="+",na={type:"literal",value:"+",description:'"+"'},oa="-",pa={type:"literal",value:"-",description:'"-"'},qa="OR",ra={type:"literal",value:"OR",description:'"OR"'},sa="XOR",ta={type:"literal",value:"XOR",description:'"XOR"'},ua="AND",va={type:"literal",value:"AND",description:'"AND"'},wa="ABS",xa={type:"literal",value:"ABS",description:'"ABS"'},ya="ACOS",za={type:"literal",value:"ACOS",description:'"ACOS"'},Aa="ASIN",Ba={type:"literal",value:"ASIN",description:'"ASIN"'},Ca="COS",Da={type:"literal",value:"COS",description:'"COS"'},Ea="EXP",Fa={type:"literal",value:"EXP",description:'"EXP"'},Ga="FIX",Ha={type:"literal",value:"FIX",description:'"FIX"'},Ia="FUP",Ja={type:"literal",value:"FUP",description:'"FUP"'},Ka="ROUND",La={type:"literal",value:"ROUND",description:'"ROUND"'},Ma="LN",Na={type:"literal",value:"LN",description:'"LN"'},Oa="SIN",Pa={type:"literal",value:"SIN",description:'"SIN"'},Qa="SQRT",Ra={type:"literal",value:"SQRT",description:'"SQRT"'},Sa="TAN",Ta={type:"literal",value:"TAN",description:'"TAN"'},Ua="EXISTS",Va={type:"literal",value:"EXISTS",description:'"EXISTS"'},Wa="A",Xa={type:"literal",value:"A",description:'"A"'},Ya="B",Za={type:"literal",value:"B",description:'"B"'},$a="C",_a={type:"literal",value:"C",description:'"C"'},ab="D",bb={type:"literal",value:"D",description:'"D"'},cb="F",db={type:"literal",value:"F",description:'"F"'},eb="G",fb={type:"literal",value:"G",description:'"G"'},gb="H",hb={type:"literal",value:"H",description:'"H"'},ib="I",jb={type:"literal",value:"I",description:'"I"'},kb="J",lb={type:"literal",value:"J",description:'"J"'},mb="K",nb={type:"literal",value:"K",description:'"K"'},ob="L",pb={type:"literal",value:"L",description:'"L"'},qb="M",rb={type:"literal",value:"M",description:'"M"'},sb="P",tb={type:"literal",value:"P",description:'"P"'},ub="Q",vb={type:"literal",value:"Q",description:'"Q"'},wb="R",xb={type:"literal",value:"R",description:'"R"'},yb="S",zb={type:"literal",value:"S",description:'"S"'},Ab="T",Bb={type:"literal",value:"T",description:'"T"'},Cb="X",Db={type:"literal",value:"X",description:'"X"'},Eb="Y",Fb={type:"literal",value:"Y",description:'"Y"'},Gb="Z",Hb={type:"literal",value:"Z",description:'"Z"'},Ib=0,Jb=0,Kb=0,Lb={line:1,column:1,seenCR:!1},Mb=0,Nb=[],Ob=0;if("startRule"in A){if(!(A.startRule in C))throw new Error("Can't start parsing from rule \""+A.startRule+'".');D=C[A.startRule]}if(buildTree=function(a,b){if(0==b.length)return a;var c=b.shift(),d=c[0],e=c[1];return{left:a,right:buildTree(e,b),op:d}},z=D(),z!==B&&Ib===a.length)return z;throw z!==B&&Ib<a.length&&e({type:"end",description:"end of input"}),f(null,Nb,Mb)}return a(b,Error),{SyntaxError:b,parse:c}}();b.GParser=c}])});

(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var r;if(typeof window!=="undefined"){r=window}else if(typeof global!=="undefined"){r=global}else if(typeof self!=="undefined"){r=self}else{r=this}r.dxf=e()}})(function(){var e,r,t;return function(){function l(i,o,u){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=o[t]={exports:{}};i[t][0].call(a.exports,function(e){var r=i[t][1][e];return s(r||e)},a,a.exports,l,i,o,u)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}return l}()({1:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,r,t){if(r)n(e.prototype,r);if(t)n(e,t);return e}}();function o(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(){o(this,e);var t=Infinity;var n=-Infinity;var a=-Infinity;var i=Infinity;Object.defineProperty(this,"minX",{get:function e(){return t}});Object.defineProperty(this,"maxX",{get:function e(){return n}});Object.defineProperty(this,"maxY",{get:function e(){return a}});Object.defineProperty(this,"minY",{get:function e(){return i}});Object.defineProperty(this,"width",{get:function e(){return n-t}});Object.defineProperty(this,"height",{get:function e(){return a-i}});this.expandByPoint=function(e,r){if(e<t){t=e}if(e>n){n=e}if(r<i){i=r}if(r>a){a=r}}}n(e,[{key:"toString",value:function e(){return"min: "+this.minX+","+this.minY+" max: "+this.maxX+","+this.maxY}},{key:"expandByTranslatedBox",value:function e(r,t,n){this.expandByPoint(r.minX+t,r.maxY+n);this.expandByPoint(r.maxX+t,r.minY+n)}},{key:"expandByBox",value:function e(r){this.expandByPoint(r.minX,r.maxY);this.expandByPoint(r.maxX,r.minY)}}]);return e}();t.default=a},{}],2:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={verbose:false}},{}],3:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("lodash.clonedeep");var f=i(n);var a=e("./util/logger");var d=i(a);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var l=e.blocks.reduce(function(e,r){e[r.name]=r;return e},{});var r=function u(e,s){var c=[];e.forEach(function(e){if(e.type==="INSERT"){var t=e;var r=l[t.block];if(!r){d.default.error("no block found for insert. block:",t.block);return}var n={x:t.x+r.x,y:t.y+r.y,xScale:t.xscale,yScale:t.yscale,rotation:t.rotation};var a=s.slice(0);a.push(n);var i=r.entities.map(function(e){var r=(0,f.default)(e);r.layer=t.layer;return r});c=c.concat(u(i,a))}else{var o=(0,f.default)(e);o.transforms=s.slice().reverse();c.push(o)}});return c};return r(e.entities,[])}},{"./util/logger":27,"lodash.clonedeep":39}],4:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("b-spline");var p=o(n);var a=e("./util/logger");var d=o(a);var i=e("./util/createArcForLWPolyline");var v=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var y=function e(r,t){return r.map(function(e){return[e[0]*Math.cos(t)-e[1]*Math.sin(t),e[1]*Math.cos(t)+e[0]*Math.sin(t)]})};var h=function e(r,t,n,a,i,o,u){if(o<i){o+=Math.PI*2}var s=[];var c=Math.PI*2/72;var l=1e-6;for(var f=i;f<o-l;f+=c){s.push([Math.cos(f)*n,Math.sin(f)*a])}s.push([Math.cos(o)*n,Math.sin(o)*a]);if(u){s=y(s,u)}s=s.map(function(e){return[r+e[0],t+e[1]]});return s};var b=function e(r,t,n,a){var i=[];var o=r.map(function(e){return[e.x,e.y]});var u=[n[t]];var s=[n[t],n[n.length-1-t]];for(var c=t+1;c<n.length-t;++c){if(u[u.length-1]!==n[c]){u.push(n[c])}}a=a||25;for(var l=1;l<u.length;++l){var f=u[l-1];var d=u[l];for(var v=0;v<=a;++v){try{var y=v/a*(d-f)+f;var h=(y-s[0])/(s[1]-s[0]);var b=(0,p.default)(h,t,o,n);i.push(b)}catch(e){}}}return i};var x=function e(r,t){t.forEach(function(n){r=r.map(function(e){var r=[e[0],e[1]];if(n.xScale){r[0]=r[0]*n.xScale}if(n.yScale){r[1]=r[1]*n.yScale}if(n.rotation){var t=n.rotation/180*Math.PI;r=[r[0]*Math.cos(t)-r[1]*Math.sin(t),r[1]*Math.cos(t)+r[0]*Math.sin(t)]}if(n.x){r[0]=r[0]+n.x}if(n.y){r[1]=r[1]+n.y}return r})});return r};t.default=function(r,e){e=e||{};var t=void 0;if(r.type==="LINE"){t=[[r.start.x,r.start.y],[r.end.x,r.end.y]]}if(r.type==="LWPOLYLINE"||r.type==="POLYLINE"){t=[];if(r.polygonMesh||r.polyfaceMesh){}else if(r.vertices.length){if(r.closed){r.vertices=r.vertices.concat(r.vertices[0])}for(var n=0,a=r.vertices.length;n<a-1;++n){var i=[r.vertices[n].x,r.vertices[n].y];var o=[r.vertices[n+1].x,r.vertices[n+1].y];t.push(i);if(r.vertices[n].bulge){t=t.concat((0,v.default)(i,o,r.vertices[n].bulge))}if(n===a-2){t.push(o)}}}else{d.default.warn("Polyline entity with no vertices")}}if(r.type==="CIRCLE"){t=h(r.x,r.y,r.r,r.r,0,Math.PI*2)}if(r.type==="ELLIPSE"){var u=Math.sqrt(r.majorX*r.majorX+r.majorY*r.majorY);var s=r.axisRatio*u;var c=-Math.atan2(-r.majorY,r.majorX);t=h(r.x,r.y,u,s,r.startAngle,r.endAngle,c);var l=r.extrusionZ===-1;if(l){t=t.map(function(e){return[-(e[0]-r.x)+r.x,e[1]]})}}if(r.type==="ARC"){t=h(r.x,r.y,r.r,r.r,r.startAngle,r.endAngle,undefined,false);var f=r.extrusionZ===-1;if(f){t=t.map(function(e){return[-e[0],e[1]]})}}if(r.type==="SPLINE"){t=b(r.controlPoints,r.degree,r.knots,e.interpolationsPerSplineSegment)}if(!t){d.default.warn("unsupported entity for converting to polyline:",r.type);return[]}return x(t,r.transforms)}},{"./util/createArcForLWPolyline":26,"./util/logger":27,"b-spline":28}],5:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){return e.reduce(function(e,r){var t=r.layer;if(!e[t]){e[t]=[]}e[t].push(r);return e},{})}},{}],6:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("./entities");var u=a(n);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var n=void 0;var a=[];var i=void 0;var o=[];e.forEach(function(e){var r=e[0];var t=e[1];if(t==="BLOCK"){n="block";i={};o=[];a.push(i)}else if(t==="ENDBLK"){if(n==="entities"){i.entities=(0,u.default)(o)}else{i.entities=[]}o=undefined;n=undefined}else if(n==="block"&&r!==0){switch(r){case 1:i.xref=t;break;case 2:i.name=t;break;case 10:i.x=t;break;case 20:i.y=t;break;case 30:i.z=t;break;default:break}}else if(n==="block"&&r===0){n="entities";o.push(e)}else if(n==="entities"){o.push(e)}});return a}},{"./entities":7}],7:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../util/logger");var o=O(n);var a=e("./entity/point");var i=O(a);var u=e("./entity/line");var s=O(u);var c=e("./entity/lwpolyline");var l=O(c);var f=e("./entity/polyline");var d=O(f);var v=e("./entity/vertex");var y=O(v);var h=e("./entity/circle");var b=O(h);var p=e("./entity/arc");var x=O(p);var m=e("./entity/ellipse");var k=O(m);var g=e("./entity/spline");var P=O(g);var M=e("./entity/solid");var _=O(M);var E=e("./entity/mtext");var w=O(E);var j=e("./entity/insert");var T=O(j);function O(e){return e&&e.__esModule?e:{default:e}}var Y=[i.default,s.default,l.default,d.default,y.default,b.default,x.default,k.default,P.default,_.default,w.default,T.default].reduce(function(e,r){e[r.TYPE]=r;return e},{});t.default=function(e){var a=[];var t=[];var n=void 0;e.forEach(function(e){var r=e[0];if(r===0){n=[];t.push(n)}n.push(e)});var i=void 0;t.forEach(function(e){var r=e[0][1];var t=e.slice(1);if(Y.hasOwnProperty(r)){var n=Y[r].process(t);if(r==="POLYLINE"){i=n;a.push(n)}else if(r==="VERTEX"){if(i){i.vertices.push(n)}else{o.default.error("ignoring invalid VERTEX entity")}}else if(r==="SEQEND"){i=undefined}else{a.push(n)}}else{o.default.warn("unsupported type in ENTITIES section:",r)}});return a}},{"../util/logger":27,"./entity/arc":8,"./entity/circle":9,"./entity/ellipse":11,"./entity/insert":12,"./entity/line":13,"./entity/lwpolyline":14,"./entity/mtext":15,"./entity/point":16,"./entity/polyline":17,"./entity/solid":18,"./entity/spline":19,"./entity/vertex":20}],8:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="ARC";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;case 40:e.r=n;break;case 50:e.startAngle=n/180*Math.PI;break;case 51:e.endAngle=n/180*Math.PI;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],9:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="CIRCLE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 40:e.r=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],10:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e,r){switch(e){case 6:return{lineTypeName:r};case 8:return{layer:r};case 48:return{lineTypeScale:r};case 60:return{visible:r===0};case 62:return{colorNumber:r};case 210:return{extrusionX:r};case 220:return{extrusionY:r};case 230:return{extrusionZ:r};default:return{}}}},{}],11:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="ELLIPSE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 11:e.majorX=n;break;case 20:e.y=n;break;case 21:e.majorY=n;break;case 30:e.z=n;break;case 31:e.majorZ=n;break;case 40:e.axisRatio=n;break;case 41:e.startAngle=n;break;case 42:e.endAngle=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],12:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="INSERT";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.block=n;break;case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 41:e.xscale=n;break;case 42:e.yscale=n;break;case 43:e.zscale=n;break;case 44:e.columnSpacing=n;break;case 45:e.rowSpacing=n;break;case 50:e.rotation=n;break;case 70:e.columnCount=n;break;case 71:e.rowCount=n;break;case 210:e.xExtrusion=n;break;case 220:e.yExtrusion=n;break;case 230:e.zExtrusion=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],13:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="LINE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.start.x=n;break;case 20:e.start.y=n;break;case 30:e.start.z=n;break;case 39:e.thickness=n;break;case 11:e.end.x=n;break;case 21:e.end.y=n;break;case 31:e.end.z=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,start:{},end:{}})};t.default={TYPE:o,process:u}},{"./common":10}],14:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="LWPOLYLINE";var u=t.process=function e(r){var a=void 0;return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 70:e.closed=(n&1)===1;break;case 10:a={x:n,y:0};e.vertices.push(a);break;case 20:a.y=n;break;case 39:e.thickness=n;break;case 42:a.bulge=n;break;default:Object.assign(e,(0,i.default)(t,n));break}return e},{type:o,vertices:[]})};t.default={TYPE:o,process:u}},{"./common":10}],15:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="MTEXT";var u={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"};var s=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];if(u.hasOwnProperty(t)){e[u[t]]=n}else if(t===1||t===3){e.string+=n}else if(t===50){e.xAxisX=Math.cos(n);e.xAxisY=Math.sin(n)}else{Object.assign(e,(0,a.default)(t,n))}return e},{type:o,string:""})};t.default={TYPE:o,process:s}},{"./common":10}],16:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="POINT";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],17:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="POLYLINE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 70:e.closed=(n&1)===1;e.polygonMesh=(n&16)===16;e.polyfaceMesh=(n&64)===64;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,vertices:[]})};t.default={TYPE:o,process:u}},{"./common":10}],18:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="SOLID";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.corners[0].x=n;break;case 20:e.corners[0].y=n;break;case 30:e.corners[0].z=n;break;case 11:e.corners[1].x=n;break;case 21:e.corners[1].y=n;break;case 31:e.corners[1].z=n;break;case 12:e.corners[2].x=n;break;case 22:e.corners[2].y=n;break;case 32:e.corners[2].z=n;break;case 13:e.corners[3].x=n;break;case 23:e.corners[3].y=n;break;case 33:e.corners[3].z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,corners:[{},{},{},{}]})};t.default={TYPE:o,process:u}},{"./common":10}],19:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="SPLINE";var u=t.process=function e(r){var a=void 0;return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:a={x:n,y:0};e.controlPoints.push(a);break;case 20:a.y=n;break;case 30:a.z=n;break;case 40:e.knots.push(n);break;case 42:e.knotTolerance=n;break;case 43:e.controlPointTolerance=n;break;case 44:e.fitTolerance=n;break;case 70:e.flag=n;e.closed=(n&1)===1;break;case 71:e.degree=n;break;case 72:e.numberOfKnots=n;break;case 73:e.numberOfControlPoints=n;break;case 74:e.numberOfFitPoints=n;break;default:Object.assign(e,(0,i.default)(t,n));break}return e},{type:o,controlPoints:[],knots:[]})};t.default={TYPE:o,process:u}},{"./common":10}],20:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.TYPE="VERTEX";var a=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 42:e.bulge=n;break;default:break}return e},{})};t.default={TYPE:n,process:a}},{}],21:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){var n=void 0;var a={};e.forEach(function(e){var r=e[0];var t=e[1];switch(t){case"$EXTMIN":a.extMin={};n="extMin";return;case"$EXTMAX":a.extMax={};n="extMax";return;default:if(n==="extMin"){switch(r){case 10:a.extMin.x=t;break;case 20:a.extMin.y=t;break;case 30:a.extMin.z=t;n=undefined;break}}if(n==="extMax"){switch(r){case 10:a.extMax.x=t;break;case 20:a.extMax.y=t;break;case 30:a.extMax.z=t;n=undefined;break}}}});return a}},{}],22:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../util/logger");var u=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var i=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.name=n;break;case 6:e.lineTypeName=n;break;case 62:e.colorNumber=n;break;case 70:e.flags=n;break;case 290:e.plot=parseInt(n)!==0;break;case 370:e.lineWeightEnum=n;break;default:}return e},{type:"LAYER"})};var o=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.name=n;break;case 6:e.lineTypeName=n;break;case 40:e.fixedTextHeight=n;break;case 41:e.widthFactor=n;break;case 50:e.obliqueAngle=n;break;case 71:e.flags=n;break;case 42:e.lastHeightUsed=n;break;case 3:e.primaryFontFileName=n;break;case 4:e.bigFontFileName=n;break;default:}return e},{type:"STYLE"})};var s=function e(r,n,a){var i=[];var o=void 0;r.forEach(function(e){var r=e[0];var t=e[1];if((r===0||r===2)&&t===n){o=[];i.push(o)}else{o.push(e)}});return i.reduce(function(e,r){var t=a(r);if(t.name){e[t.name]=t}else{u.default.warn("table row without name:",t)}return e},{})};t.default=function(e){var t=[];var n=void 0;e.forEach(function(e){var r=e[1];if(r==="TABLE"){n=[];t.push(n)}else if(r==="ENDTAB"){t.push(n)}else{n.push(e)}});var r=[];var a=[];t.forEach(function(e){if(e[0][1]==="STYLE"){r=e}else if(e[0][1]==="LTYPE"){u.default.warn("LTYPE in tables not supported")}else if(e[0][1]==="LAYER"){a=e}});return{layers:s(a,"LAYER",i),styles:s(r,"STYLE",o)}}},{"../util/logger":27}],23:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.entityToPolyline=t.toSVG=t.groupEntitiesByLayer=t.denormalise=t.BoundingBox=t.colors=t.config=t.parseString=undefined;var n=e("./handlers/header");var i=E(n);var a=e("./handlers/tables");var o=E(a);var u=e("./handlers/blocks");var s=E(u);var c=e("./handlers/entities");var l=E(c);var f=e("./config");var d=E(f);var v=e("./BoundingBox");var y=E(v);var h=e("./denormalise");var b=E(h);var p=e("./groupEntitiesByLayer");var x=E(p);var m=e("./toSVG");var k=E(m);var g=e("./util/colors");var P=E(g);var M=e("./entityToPolyline");var _=E(M);function E(e){return e&&e.__esModule?e:{default:e}}var w=function e(r){var t=r.split(/\r\n|\r|\n/g);var n=t.filter(function(e){return e.trim!=="EOF"});return n};var j=function e(r,t){if(r>=10&&r<60){return parseFloat(t,10)}else if(r>=210&&r<240){return parseFloat(t,10)}else if(r>=60&&r<100){return parseInt(t,10)}else{return t}};var T=function e(r){var t="type";var n=void 0;var a=[];var i=true;var o=false;var u=undefined;try{for(var s=r[Symbol.iterator](),c;!(i=(c=s.next()).done);i=true){var l=c.value;if(t==="type"){n=parseInt(l,10);t="value"}else{a.push([n,j(n,l)]);t="type"}}}catch(e){o=true;u=e}finally{try{if(!i&&s.return){s.return()}}finally{if(o){throw u}}}return a};var O=function e(r){var t=void 0;return r.reduce(function(e,r){if(r[0]===0&&r[1]==="SECTION"){t=[]}else if(r[0]===0&&r[1]==="ENDSEC"){e.push(t);t=undefined}else if(t!==undefined){t.push(r)}return e},[])};var Y=function e(r,t){var n=t[0][1];var a=t.slice(1);switch(n){case"HEADER":r.header=(0,i.default)(a);break;case"TABLES":r.tables=(0,o.default)(a);break;case"BLOCKS":r.blocks=(0,s.default)(a);break;case"ENTITIES":r.entities=(0,l.default)(a);break;default:}return r};var B=t.parseString=function e(r){var t=w(r);var n=T(t);var a=O(n);var i=a.reduce(Y,{header:{},blocks:[],entities:[]});return i};t.config=d.default;t.colors=P.default;t.BoundingBox=y.default;t.denormalise=b.default;t.groupEntitiesByLayer=x.default;t.toSVG=k.default;t.entityToPolyline=_.default},{"./BoundingBox":1,"./config":2,"./denormalise":3,"./entityToPolyline":4,"./groupEntitiesByLayer":5,"./handlers/blocks":6,"./handlers/entities":7,"./handlers/header":21,"./handlers/tables":22,"./toSVG":24,"./util/colors":25}],24:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("pretty-data");var a=e("./BoundingBox");var i=y(a);var o=e("./denormalise");var l=y(o);var u=e("./entityToPolyline");var f=y(u);var s=e("./util/colors");var d=y(s);var c=e("./util/logger");var v=y(c);function y(e){return e&&e.__esModule?e:{default:e}}var h=function e(r,t){var n=r[2]|r[1]<<8|r[0]<<16;var a=n.toString(16);for(var i=0,o=6-a.length;i<o;++i){a="0"+a}var u="#"+a;if(u==="#ffffff"){u="#000000"}var s=t.reduce(function(e,r,t){e+=t===0?"M":"L";e+=Math.round(r[0]*10)/10+","+Math.round(r[1]*10)/10;return e},"");return'<path fill="none" stroke="'+u+'" stroke-width="0.1%" d="'+s+'"/>'};t.default=function(u){var s=(0,l.default)(u);var e=s.map(function(e){return(0,f.default)(e)});var r=new i.default;e.forEach(function(e){e.forEach(function(e){r.expandByPoint(e[0],e[1])})});var c=[];e.forEach(function(e,r){var t=s[r];var n=u.tables.layers[t.layer];var a=void 0;if(n){var i="colorNumber"in t?t.colorNumber:n.colorNumber;a=d.default[i];if(a===undefined){v.default.warn("Color index",i,"invalid, defaulting to black");a=[0,0,0]}}else{v.default.warn("no layer table for layer:"+t.layer);a=[0,0,0]}var o=e.map(function(e){return[e[0],-e[1]]});c.push(h(a,o))});var t='<?xml version="1.0"?>';t+='<svg xmlns="http://www.w3.org/2000/svg"';t+=' xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"';t+=' preserveAspectRatio="xMinYMin meet"';t+=' viewBox="'+r.minX+" "+-r.maxY+" "+r.width+" "+r.height+'"';t+=' width="100%" height="100%">'+c.join("")+"</svg>";return n.pd.xml(t)}},{"./BoundingBox":1,"./denormalise":3,"./entityToPolyline":4,"./util/colors":25,"./util/logger":27,"pretty-data":42}],25:[function(e,r,t){},{}],26:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var P=e("vecks");t.default=function(e,r,t,n){if(!n){n=5}var a=void 0;var i=void 0;var o=void 0;if(t<0){a=Math.atan(-t)*4;i=new P.V2(e[0],e[1]);o=new P.V2(r[0],r[1])}else{a=Math.atan(t)*4;i=new P.V2(r[0],r[1]);o=new P.V2(e[0],e[1])}var u=o.sub(i);var s=u.length();var c=i.add(u.multiply(.5));var l=Math.abs(s/2/Math.tan(a/2));var f=u.norm();var d=void 0;if(a<Math.PI){var v=new P.V2(f.x*Math.cos(Math.PI/2)-f.y*Math.sin(Math.PI/2),f.y*Math.cos(Math.PI/2)+f.x*Math.sin(Math.PI/2));d=c.add(v.multiply(-l))}else{var y=new P.V2(f.x*Math.cos(Math.PI/2)-f.y*Math.sin(Math.PI/2),f.y*Math.cos(Math.PI/2)+f.x*Math.sin(Math.PI/2));d=c.add(y.multiply(l))}var h=Math.atan2(o.y-d.y,o.x-d.x)/Math.PI*180;var b=Math.atan2(i.y-d.y,i.x-d.x)/Math.PI*180;if(b<h){b+=360}var p=o.sub(d).length();var x=Math.floor(h/n)*n+n;var m=Math.ceil(b/n)*n-n;var k=[];for(var g=x;g<=m;g+=n){k.push(d.add(new P.V2(Math.cos(g/180*Math.PI)*p,Math.sin(g/180*Math.PI)*p)))}if(t<0){k.reverse()}return k.map(function(e){return[e.x,e.y]})}},{vecks:51}],27:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../config");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}function o(){if(a.default.verbose){console.info.apply(undefined,arguments)}}function u(){if(a.default.verbose){console.warn.apply(undefined,arguments)}}function s(){console.error.apply(undefined,arguments)}t.default={info:o,warn:u,error:s}},{"../config":2}],28:[function(e,r,t){},{}],29:[function(e,r,t){},{}],30:[function(e,r,t){function n(e,r){var t=-1,n=e.length;while(++t<n){if(r(e[t],t,e)===false){break}}return e}r.exports=n},{}],31:[function(e,r,t){},{"lodash._basecopy":35,"lodash.keys":32}],32:[function(e,r,t){var n=e("lodash._getnative");var a=n(Object,"keys");var i=function(e){return a(e)};r.exports=i},{"lodash._getnative":38,"lodash.isarguments":40,"lodash.isarray":41}],33:[function(D,W,e){(function(e){var d=D("lodash._arraycopy"),v=D("lodash._arrayeach"),y=D("lodash._baseassign"),t=D("lodash._basefor"),h=D("lodash.isarray"),n=D("lodash.keys");var b="[object Arguments]",r="[object Array]",o="[object Boolean]",u="[object Date]",a="[object Error]",p="[object Function]",i="[object Map]",s="[object Number]",x="[object Object]",c="[object RegExp]",l="[object Set]",f="[object String]",m="[object WeakMap]";var k="[object ArrayBuffer]",g="[object Float32Array]",P="[object Float64Array]",M="[object Int8Array]",_="[object Int16Array]",E="[object Int32Array]",w="[object Uint8Array]",j="[object Uint8ClampedArray]",T="[object Uint16Array]",O="[object Uint32Array]";var Y=/\w*$/;var B={};B[b]=B[r]=B[k]=B[o]=B[u]=B[g]=B[P]=B[M]=B[_]=B[E]=B[s]=B[x]=B[c]=B[f]=B[w]=B[j]=B[T]=B[O]=true;B[a]=B[p]=B[i]=B[l]=B[m]=false;var I=Object.prototype;var L=I.hasOwnProperty;var S=I.toString;var A=e.ArrayBuffer,N=e.Uint8Array;function C(t,n,a,e,r,i,o){var u;if(a){u=r?a(t,e,r):a(t)}if(u!==undefined){return u}if(!G(t)){return t}var s=h(t);if(s){u=X(t);if(!n){return d(t,u)}}else{var c=S.call(t),l=c==p;if(c==x||c==b||l&&!r){u=z(l?{}:t);if(!n){return y(u,t)}}else{return B[c]?F(t,c,n):r?t:{}}}i||(i=[]);o||(o=[]);var f=i.length;while(f--){if(i[f]==t){return o[f]}}i.push(t);o.push(u);(s?v:R)(t,function(e,r){u[r]=C(e,n,a,r,t,i,o)});return u}function R(e,r){return t(e,r,n)}function V(e){var r=new A(e.byteLength),t=new N(r);t.set(new N(e));return r}function X(e){var r=e.length,t=new e.constructor(r);if(r&&typeof e[0]=="string"&&L.call(e,"index")){t.index=e.index;t.input=e.input}return t}function z(e){var r=e.constructor;if(!(typeof r=="function"&&r instanceof r)){r=Object}return new r}function F(e,r,t){var n=e.constructor;switch(r){case k:return V(e);case o:case u:return new n(+e);case g:case P:case M:case _:case E:case w:case j:case T:case O:var a=e.buffer;return new n(t?V(a):a,e.byteOffset,e.length);case s:case f:return new n(e);case c:var i=new n(e.source,Y.exec(e));i.lastIndex=e.lastIndex}return i}function G(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}W.exports=C}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"lodash._arraycopy":29,"lodash._arrayeach":30,"lodash._baseassign":31,"lodash._basefor":36,"lodash.isarray":41,"lodash.keys":34}],34:[function(e,r,t){arguments[4][32][0].apply(t,arguments)},{dup:32,"lodash._getnative":38,"lodash.isarguments":40,"lodash.isarray":41}],35:[function(e,r,t){},{}],36:[function(e,r,t){var n=a();function a(s){return function(e,r,t){var n=-1,a=Object(e),i=t(e),o=i.length;while(o--){var u=i[s?o:++n];if(r(a[u],u,a)===false){break}}return e}}r.exports=n},{}],37:[function(e,r,t){},{}],38:[function(e,r,t){function n(e,r){var t=e==null?undefined:e[r];return a(t)?t:undefined}function a(e){if(e==null){return false}return true}r.exports=n},{}],39:[function(e,r,t){var n=e("lodash._baseclone"),a=e("lodash._bindcallback");function i(e,r,t){return typeof r=="function"?n(e,true,a(r,t,3)):n(e,true)}r.exports=i},{"lodash._baseclone":33,"lodash._bindcallback":37}],40:[function(e,r,t){},{}],41:[function(e,r,t){var n=a(Array,"isArray");function a(e,r){var t=e==null?undefined:e[r];return o(t)?t:undefined}var i=n;function o(e){if(e==null){return false}return true}r.exports=i},{}],42:[function(e,r,t){function n(){this.shift=["\n"];this.step="  ",maxdeep=100,ix=0;for(ix=0;ix<maxdeep;ix++){this.shift.push(this.shift[ix]+this.step)}}n.prototype.xml=function(e){var r=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/xmlns\:/g,"~::~xmlns:").replace(/xmlns\=/g,"~::~xmlns=").split("~::~"),t=r.length,n=false,a=0,i="",o=0;for(o=0;o<t;o++){if(r[o].search(/<!/)>-1){i+=this.shift[a]+r[o];n=true;if(r[o].search(/-->/)>-1||r[o].search(/\]>/)>-1||r[o].search(/!DOCTYPE/)>-1){n=false}}else if(r[o].search(/-->/)>-1||r[o].search(/\]>/)>-1){i+=r[o];n=false}else if(/^<\w/.exec(r[o-1])&&/^<\/\w/.exec(r[o])&&/^<[\w:\-\.\,]+/.exec(r[o-1])==/^<\/[\w:\-\.\,]+/.exec(r[o])[0].replace("/","")){i+=r[o];if(!n)a--}else if(r[o].search(/<\w/)>-1&&r[o].search(/<\//)==-1&&r[o].search(/\/>/)==-1){i=!n?i+=this.shift[a++]+r[o]:i+=r[o]}else if(r[o].search(/<\w/)>-1&&r[o].search(/<\//)>-1){i=!n?i+=this.shift[a]+r[o]:i+=r[o]}else if(r[o].search(/<\//)>-1){i=!n?i+=this.shift[--a]+r[o]:i+=r[o]}else if(r[o].search(/\/>/)>-1){i=!n?i+=this.shift[a]+r[o]:i+=r[o]}else if(r[o].search(/<\?/)>-1){i+=this.shift[a]+r[o]}else if(r[o].search(/xmlns\:/)>-1||r[o].search(/xmlns\=/)>-1){i+=this.shift[a]+r[o]}else{i+=r[o]}}return i[0]=="\n"?i.slice(1):i};n.prototype.xmlmin=function(e,r){var t=r?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"");return t.replace(/>\s{0,}</g,"><")};t.pd=new n},{}],43:[function(e,r,t){},{"./V2":49}],44:[function(e,r,t){},{}],45:[function(e,r,t){},{"./V2":49}],46:[function(e,r,t){},{"./V3":50}],47:[function(e,r,t){},{}],48:[function(e,r,t){},{"./V3":50}],49:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,r,t){if(r)n(e.prototype,r);if(t)n(e,t);return e}}();function i(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function t(e,r){i(this,t);if((typeof e==="undefined"?"undefined":n(e))==="object"){this.x=e.x;this.y=e.y}else{this.x=e;this.y=r}}a(t,[{key:"equals",value:function e(r){return this.x===r.x&&this.y===r.y}},{key:"length",value:function e(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function e(){return new t(-this.x,-this.y)}},{key:"add",value:function e(r){return new t(this.x+r.x,this.y+r.y)}},{key:"sub",value:function e(r){return new t(this.x-r.x,this.y-r.y)}},{key:"multiply",value:function e(r){return new t(this.x*r,this.y*r)}},{key:"norm",value:function e(){return this.multiply(1/this.length())}},{key:"dot",value:function e(r){return this.x*r.x+this.y*r.y}}]);return t}();t.default=o},{}],50:[function(e,r,t){},{}],51:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Line3=t.Line2=t.Quaternion=t.Plane3=t.Box3=t.Box2=t.V3=t.V2=undefined;var n=e("./V2");var a=m(n);var i=e("./V3");var o=m(i);var u=e("./Box2");var s=m(u);var c=e("./Box3");var l=m(c);var f=e("./Plane3");var d=m(f);var v=e("./Quaternion");var y=m(v);var h=e("./Line2");var b=m(h);var p=e("./Line3");var x=m(p);function m(e){return e&&e.__esModule?e:{default:e}}t.V2=a.default;t.V3=o.default;t.Box2=s.default;t.Box3=l.default;t.Plane3=d.default;t.Quaternion=y.default;t.Line2=b.default;t.Line3=x.default},{"./Box2":43,"./Box3":44,"./Line2":45,"./Line3":46,"./Plane3":47,"./Quaternion":48,"./V2":49,"./V3":50}]},{},[23])(23)});