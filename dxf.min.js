(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var r;if(typeof window!=="undefined"){r=window}else if(typeof global!=="undefined"){r=global}else if(typeof self!=="undefined"){r=self}else{r=this}r.dxf=e()}})(function(){var e,r,t;return function(){function l(i,o,u){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=o[t]={exports:{}};i[t][0].call(a.exports,function(e){var r=i[t][1][e];return s(r||e)},a,a.exports,l,i,o,u)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}return l}()({1:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,r,t){if(r)n(e.prototype,r);if(t)n(e,t);return e}}();function o(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(){o(this,e);var t=Infinity;var n=-Infinity;var a=-Infinity;var i=Infinity;Object.defineProperty(this,"minX",{get:function e(){return t}});Object.defineProperty(this,"maxX",{get:function e(){return n}});Object.defineProperty(this,"maxY",{get:function e(){return a}});Object.defineProperty(this,"minY",{get:function e(){return i}});Object.defineProperty(this,"width",{get:function e(){return n-t}});Object.defineProperty(this,"height",{get:function e(){return a-i}});this.expandByPoint=function(e,r){if(e<t){t=e}if(e>n){n=e}if(r<i){i=r}if(r>a){a=r}}}n(e,[{key:"toString",value:function e(){return"min: "+this.minX+","+this.minY+" max: "+this.maxX+","+this.maxY}},{key:"expandByTranslatedBox",value:function e(r,t,n){this.expandByPoint(r.minX+t,r.maxY+n);this.expandByPoint(r.maxX+t,r.minY+n)}},{key:"expandByBox",value:function e(r){this.expandByPoint(r.minX,r.maxY);this.expandByPoint(r.maxX,r.minY)}}]);return e}();t.default=a},{}],2:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={verbose:false}},{}],3:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("lodash.clonedeep");var f=i(n);var a=e("./util/logger");var d=i(a);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var l=e.blocks.reduce(function(e,r){e[r.name]=r;return e},{});var r=function u(e,s){var c=[];e.forEach(function(e){if(e.type==="INSERT"){var t=e;var r=l[t.block];if(!r){d.default.error("no block found for insert. block:",t.block);return}var n={x:t.x+r.x,y:t.y+r.y,xScale:t.xscale,yScale:t.yscale,rotation:t.rotation};var a=s.slice(0);a.push(n);var i=r.entities.map(function(e){var r=(0,f.default)(e);r.layer=t.layer;return r});c=c.concat(u(i,a))}else{var o=(0,f.default)(e);o.transforms=s.slice().reverse();c.push(o)}});return c};return r(e.entities,[])}},{"./util/logger":27,"lodash.clonedeep":39}],4:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("b-spline");var p=o(n);var a=e("./util/logger");var d=o(a);var i=e("./util/createArcForLWPolyline");var v=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var y=function e(r,t){return r.map(function(e){return[e[0]*Math.cos(t)-e[1]*Math.sin(t),e[1]*Math.cos(t)+e[0]*Math.sin(t)]})};var h=function e(r,t,n,a,i,o,u){if(o<i){o+=Math.PI*2}var s=[];var c=Math.PI*2/72;var l=1e-6;for(var f=i;f<o-l;f+=c){s.push([Math.cos(f)*n,Math.sin(f)*a])}s.push([Math.cos(o)*n,Math.sin(o)*a]);if(u){s=y(s,u)}s=s.map(function(e){return[r+e[0],t+e[1]]});return s};var b=function e(r,t,n,a){var i=[];var o=r.map(function(e){return[e.x,e.y]});var u=[n[t]];var s=[n[t],n[n.length-1-t]];for(var c=t+1;c<n.length-t;++c){if(u[u.length-1]!==n[c]){u.push(n[c])}}a=a||25;for(var l=1;l<u.length;++l){var f=u[l-1];var d=u[l];for(var v=0;v<=a;++v){try{var y=v/a*(d-f)+f;var h=(y-s[0])/(s[1]-s[0]);var b=(0,p.default)(h,t,o,n);i.push(b)}catch(e){}}}return i};var x=function e(r,t){t.forEach(function(n){r=r.map(function(e){var r=[e[0],e[1]];if(n.xScale){r[0]=r[0]*n.xScale}if(n.yScale){r[1]=r[1]*n.yScale}if(n.rotation){var t=n.rotation/180*Math.PI;r=[r[0]*Math.cos(t)-r[1]*Math.sin(t),r[1]*Math.cos(t)+r[0]*Math.sin(t)]}if(n.x){r[0]=r[0]+n.x}if(n.y){r[1]=r[1]+n.y}return r})});return r};t.default=function(r,e){e=e||{};var t=void 0;if(r.type==="LINE"){t=[[r.start.x,r.start.y],[r.end.x,r.end.y]]}if(r.type==="LWPOLYLINE"||r.type==="POLYLINE"){t=[];if(r.polygonMesh||r.polyfaceMesh){}else if(r.vertices.length){if(r.closed){r.vertices=r.vertices.concat(r.vertices[0])}for(var n=0,a=r.vertices.length;n<a-1;++n){var i=[r.vertices[n].x,r.vertices[n].y];var o=[r.vertices[n+1].x,r.vertices[n+1].y];t.push(i);if(r.vertices[n].bulge){t=t.concat((0,v.default)(i,o,r.vertices[n].bulge))}if(n===a-2){t.push(o)}}}else{d.default.warn("Polyline entity with no vertices")}}if(r.type==="CIRCLE"){t=h(r.x,r.y,r.r,r.r,0,Math.PI*2)}if(r.type==="ELLIPSE"){var u=Math.sqrt(r.majorX*r.majorX+r.majorY*r.majorY);var s=r.axisRatio*u;var c=-Math.atan2(-r.majorY,r.majorX);t=h(r.x,r.y,u,s,r.startAngle,r.endAngle,c);var l=r.extrusionZ===-1;if(l){t=t.map(function(e){return[-(e[0]-r.x)+r.x,e[1]]})}}if(r.type==="ARC"){t=h(r.x,r.y,r.r,r.r,r.startAngle,r.endAngle,undefined,false);var f=r.extrusionZ===-1;if(f){t=t.map(function(e){return[-e[0],e[1]]})}}if(r.type==="SPLINE"){t=b(r.controlPoints,r.degree,r.knots,e.interpolationsPerSplineSegment)}if(!t){d.default.warn("unsupported entity for converting to polyline:",r.type);return[]}return x(t,r.transforms)}},{"./util/createArcForLWPolyline":26,"./util/logger":27,"b-spline":28}],5:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){return e.reduce(function(e,r){var t=r.layer;if(!e[t]){e[t]=[]}e[t].push(r);return e},{})}},{}],6:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("./entities");var u=a(n);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var n=void 0;var a=[];var i=void 0;var o=[];e.forEach(function(e){var r=e[0];var t=e[1];if(t==="BLOCK"){n="block";i={};o=[];a.push(i)}else if(t==="ENDBLK"){if(n==="entities"){i.entities=(0,u.default)(o)}else{i.entities=[]}o=undefined;n=undefined}else if(n==="block"&&r!==0){switch(r){case 1:i.xref=t;break;case 2:i.name=t;break;case 10:i.x=t;break;case 20:i.y=t;break;case 30:i.z=t;break;default:break}}else if(n==="block"&&r===0){n="entities";o.push(e)}else if(n==="entities"){o.push(e)}});return a}},{"./entities":7}],7:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../util/logger");var o=O(n);var a=e("./entity/point");var i=O(a);var u=e("./entity/line");var s=O(u);var c=e("./entity/lwpolyline");var l=O(c);var f=e("./entity/polyline");var d=O(f);var v=e("./entity/vertex");var y=O(v);var h=e("./entity/circle");var b=O(h);var p=e("./entity/arc");var x=O(p);var m=e("./entity/ellipse");var k=O(m);var g=e("./entity/spline");var P=O(g);var M=e("./entity/solid");var _=O(M);var E=e("./entity/mtext");var w=O(E);var j=e("./entity/insert");var T=O(j);function O(e){return e&&e.__esModule?e:{default:e}}var Y=[i.default,s.default,l.default,d.default,y.default,b.default,x.default,k.default,P.default,_.default,w.default,T.default].reduce(function(e,r){e[r.TYPE]=r;return e},{});t.default=function(e){var a=[];var t=[];var n=void 0;e.forEach(function(e){var r=e[0];if(r===0){n=[];t.push(n)}n.push(e)});var i=void 0;t.forEach(function(e){var r=e[0][1];var t=e.slice(1);if(Y.hasOwnProperty(r)){var n=Y[r].process(t);if(r==="POLYLINE"){i=n;a.push(n)}else if(r==="VERTEX"){if(i){i.vertices.push(n)}else{o.default.error("ignoring invalid VERTEX entity")}}else if(r==="SEQEND"){i=undefined}else{a.push(n)}}else{o.default.warn("unsupported type in ENTITIES section:",r)}});return a}},{"../util/logger":27,"./entity/arc":8,"./entity/circle":9,"./entity/ellipse":11,"./entity/insert":12,"./entity/line":13,"./entity/lwpolyline":14,"./entity/mtext":15,"./entity/point":16,"./entity/polyline":17,"./entity/solid":18,"./entity/spline":19,"./entity/vertex":20}],8:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="ARC";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;case 40:e.r=n;break;case 50:e.startAngle=n/180*Math.PI;break;case 51:e.endAngle=n/180*Math.PI;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],9:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="CIRCLE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 40:e.r=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],10:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e,r){switch(e){case 6:return{lineTypeName:r};case 8:return{layer:r};case 48:return{lineTypeScale:r};case 60:return{visible:r===0};case 62:return{colorNumber:r};case 210:return{extrusionX:r};case 220:return{extrusionY:r};case 230:return{extrusionZ:r};default:return{}}}},{}],11:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="ELLIPSE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 11:e.majorX=n;break;case 20:e.y=n;break;case 21:e.majorY=n;break;case 30:e.z=n;break;case 31:e.majorZ=n;break;case 40:e.axisRatio=n;break;case 41:e.startAngle=n;break;case 42:e.endAngle=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],12:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="INSERT";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.block=n;break;case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 41:e.xscale=n;break;case 42:e.yscale=n;break;case 43:e.zscale=n;break;case 44:e.columnSpacing=n;break;case 45:e.rowSpacing=n;break;case 50:e.rotation=n;break;case 70:e.columnCount=n;break;case 71:e.rowCount=n;break;case 210:e.xExtrusion=n;break;case 220:e.yExtrusion=n;break;case 230:e.zExtrusion=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],13:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="LINE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.start.x=n;break;case 20:e.start.y=n;break;case 30:e.start.z=n;break;case 39:e.thickness=n;break;case 11:e.end.x=n;break;case 21:e.end.y=n;break;case 31:e.end.z=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,start:{},end:{}})};t.default={TYPE:o,process:u}},{"./common":10}],14:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="LWPOLYLINE";var u=t.process=function e(r){var a=void 0;return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 70:e.closed=(n&1)===1;break;case 10:a={x:n,y:0};e.vertices.push(a);break;case 20:a.y=n;break;case 39:e.thickness=n;break;case 42:a.bulge=n;break;default:Object.assign(e,(0,i.default)(t,n));break}return e},{type:o,vertices:[]})};t.default={TYPE:o,process:u}},{"./common":10}],15:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="MTEXT";var u={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"};var s=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];if(u.hasOwnProperty(t)){e[u[t]]=n}else if(t===1||t===3){e.string+=n}else if(t===50){e.xAxisX=Math.cos(n);e.xAxisY=Math.sin(n)}else{Object.assign(e,(0,a.default)(t,n))}return e},{type:o,string:""})};t.default={TYPE:o,process:s}},{"./common":10}],16:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="POINT";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o})};t.default={TYPE:o,process:u}},{"./common":10}],17:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="POLYLINE";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 70:e.closed=(n&1)===1;e.polygonMesh=(n&16)===16;e.polyfaceMesh=(n&64)===64;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,vertices:[]})};t.default={TYPE:o,process:u}},{"./common":10}],18:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="SOLID";var u=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.corners[0].x=n;break;case 20:e.corners[0].y=n;break;case 30:e.corners[0].z=n;break;case 11:e.corners[1].x=n;break;case 21:e.corners[1].y=n;break;case 31:e.corners[1].z=n;break;case 12:e.corners[2].x=n;break;case 22:e.corners[2].y=n;break;case 32:e.corners[2].z=n;break;case 13:e.corners[3].x=n;break;case 23:e.corners[3].y=n;break;case 33:e.corners[3].z=n;break;case 39:e.thickness=n;break;default:Object.assign(e,(0,a.default)(t,n));break}return e},{type:o,corners:[{},{},{},{}]})};t.default={TYPE:o,process:u}},{"./common":10}],19:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.process=t.TYPE=undefined;var n=e("./common");var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=t.TYPE="SPLINE";var u=t.process=function e(r){var a=void 0;return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:a={x:n,y:0};e.controlPoints.push(a);break;case 20:a.y=n;break;case 30:a.z=n;break;case 40:e.knots.push(n);break;case 42:e.knotTolerance=n;break;case 43:e.controlPointTolerance=n;break;case 44:e.fitTolerance=n;break;case 70:e.flag=n;e.closed=(n&1)===1;break;case 71:e.degree=n;break;case 72:e.numberOfKnots=n;break;case 73:e.numberOfControlPoints=n;break;case 74:e.numberOfFitPoints=n;break;default:Object.assign(e,(0,i.default)(t,n));break}return e},{type:o,controlPoints:[],knots:[]})};t.default={TYPE:o,process:u}},{"./common":10}],20:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.TYPE="VERTEX";var a=t.process=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 10:e.x=n;break;case 20:e.y=n;break;case 30:e.z=n;break;case 42:e.bulge=n;break;default:break}return e},{})};t.default={TYPE:n,process:a}},{}],21:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){var n=void 0;var a={};e.forEach(function(e){var r=e[0];var t=e[1];switch(t){case"$EXTMIN":a.extMin={};n="extMin";return;case"$EXTMAX":a.extMax={};n="extMax";return;default:if(n==="extMin"){switch(r){case 10:a.extMin.x=t;break;case 20:a.extMin.y=t;break;case 30:a.extMin.z=t;n=undefined;break}}if(n==="extMax"){switch(r){case 10:a.extMax.x=t;break;case 20:a.extMax.y=t;break;case 30:a.extMax.z=t;n=undefined;break}}}});return a}},{}],22:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../util/logger");var u=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var i=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.name=n;break;case 6:e.lineTypeName=n;break;case 62:e.colorNumber=n;break;case 70:e.flags=n;break;case 290:e.plot=parseInt(n)!==0;break;case 370:e.lineWeightEnum=n;break;default:}return e},{type:"LAYER"})};var o=function e(r){return r.reduce(function(e,r){var t=r[0];var n=r[1];switch(t){case 2:e.name=n;break;case 6:e.lineTypeName=n;break;case 40:e.fixedTextHeight=n;break;case 41:e.widthFactor=n;break;case 50:e.obliqueAngle=n;break;case 71:e.flags=n;break;case 42:e.lastHeightUsed=n;break;case 3:e.primaryFontFileName=n;break;case 4:e.bigFontFileName=n;break;default:}return e},{type:"STYLE"})};var s=function e(r,n,a){var i=[];var o=void 0;r.forEach(function(e){var r=e[0];var t=e[1];if((r===0||r===2)&&t===n){o=[];i.push(o)}else{o.push(e)}});return i.reduce(function(e,r){var t=a(r);if(t.name){e[t.name]=t}else{u.default.warn("table row without name:",t)}return e},{})};t.default=function(e){var t=[];var n=void 0;e.forEach(function(e){var r=e[1];if(r==="TABLE"){n=[];t.push(n)}else if(r==="ENDTAB"){t.push(n)}else{n.push(e)}});var r=[];var a=[];t.forEach(function(e){if(e[0][1]==="STYLE"){r=e}else if(e[0][1]==="LTYPE"){u.default.warn("LTYPE in tables not supported")}else if(e[0][1]==="LAYER"){a=e}});return{layers:s(a,"LAYER",i),styles:s(r,"STYLE",o)}}},{"../util/logger":27}],23:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.entityToPolyline=t.toSVG=t.groupEntitiesByLayer=t.denormalise=t.BoundingBox=t.colors=t.config=t.parseString=undefined;var n=e("./handlers/header");var i=E(n);var a=e("./handlers/tables");var o=E(a);var u=e("./handlers/blocks");var s=E(u);var c=e("./handlers/entities");var l=E(c);var f=e("./config");var d=E(f);var v=e("./BoundingBox");var y=E(v);var h=e("./denormalise");var b=E(h);var p=e("./groupEntitiesByLayer");var x=E(p);var m=e("./toSVG");var k=E(m);var g=e("./util/colors");var P=E(g);var M=e("./entityToPolyline");var _=E(M);function E(e){return e&&e.__esModule?e:{default:e}}var w=function e(r){var t=r.split(/\r\n|\r|\n/g);var n=t.filter(function(e){return e.trim!=="EOF"});return n};var j=function e(r,t){if(r>=10&&r<60){return parseFloat(t,10)}else if(r>=210&&r<240){return parseFloat(t,10)}else if(r>=60&&r<100){return parseInt(t,10)}else{return t}};var T=function e(r){var t="type";var n=void 0;var a=[];var i=true;var o=false;var u=undefined;try{for(var s=r[Symbol.iterator](),c;!(i=(c=s.next()).done);i=true){var l=c.value;if(t==="type"){n=parseInt(l,10);t="value"}else{a.push([n,j(n,l)]);t="type"}}}catch(e){o=true;u=e}finally{try{if(!i&&s.return){s.return()}}finally{if(o){throw u}}}return a};var O=function e(r){var t=void 0;return r.reduce(function(e,r){if(r[0]===0&&r[1]==="SECTION"){t=[]}else if(r[0]===0&&r[1]==="ENDSEC"){e.push(t);t=undefined}else if(t!==undefined){t.push(r)}return e},[])};var Y=function e(r,t){var n=t[0][1];var a=t.slice(1);switch(n){case"HEADER":r.header=(0,i.default)(a);break;case"TABLES":r.tables=(0,o.default)(a);break;case"BLOCKS":r.blocks=(0,s.default)(a);break;case"ENTITIES":r.entities=(0,l.default)(a);break;default:}return r};var B=t.parseString=function e(r){var t=w(r);var n=T(t);var a=O(n);var i=a.reduce(Y,{header:{},blocks:[],entities:[]});return i};t.config=d.default;t.colors=P.default;t.BoundingBox=y.default;t.denormalise=b.default;t.groupEntitiesByLayer=x.default;t.toSVG=k.default;t.entityToPolyline=_.default},{"./BoundingBox":1,"./config":2,"./denormalise":3,"./entityToPolyline":4,"./groupEntitiesByLayer":5,"./handlers/blocks":6,"./handlers/entities":7,"./handlers/header":21,"./handlers/tables":22,"./toSVG":24,"./util/colors":25}],24:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("pretty-data");var a=e("./BoundingBox");var i=y(a);var o=e("./denormalise");var l=y(o);var u=e("./entityToPolyline");var f=y(u);var s=e("./util/colors");var d=y(s);var c=e("./util/logger");var v=y(c);function y(e){return e&&e.__esModule?e:{default:e}}var h=function e(r,t){var n=r[2]|r[1]<<8|r[0]<<16;var a=n.toString(16);for(var i=0,o=6-a.length;i<o;++i){a="0"+a}var u="#"+a;if(u==="#ffffff"){u="#000000"}var s=t.reduce(function(e,r,t){e+=t===0?"M":"L";e+=Math.round(r[0]*10)/10+","+Math.round(r[1]*10)/10;return e},"");return'<path fill="none" stroke="'+u+'" stroke-width="0.1%" d="'+s+'"/>'};t.default=function(u){var s=(0,l.default)(u);var e=s.map(function(e){return(0,f.default)(e)});var r=new i.default;e.forEach(function(e){e.forEach(function(e){r.expandByPoint(e[0],e[1])})});var c=[];e.forEach(function(e,r){var t=s[r];var n=u.tables.layers[t.layer];var a=void 0;if(n){var i="colorNumber"in t?t.colorNumber:n.colorNumber;a=d.default[i];if(a===undefined){v.default.warn("Color index",i,"invalid, defaulting to black");a=[0,0,0]}}else{v.default.warn("no layer table for layer:"+t.layer);a=[0,0,0]}var o=e.map(function(e){return[e[0],-e[1]]});c.push(h(a,o))});var t='<?xml version="1.0"?>';t+='<svg xmlns="http://www.w3.org/2000/svg"';t+=' xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"';t+=' preserveAspectRatio="xMinYMin meet"';t+=' viewBox="'+r.minX+" "+-r.maxY+" "+r.width+" "+r.height+'"';t+=' width="100%" height="100%">'+c.join("")+"</svg>";return n.pd.xml(t)}},{"./BoundingBox":1,"./denormalise":3,"./entityToPolyline":4,"./util/colors":25,"./util/logger":27,"pretty-data":42}],25:[function(e,r,t){},{}],26:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var P=e("vecks");t.default=function(e,r,t,n){if(!n){n=5}var a=void 0;var i=void 0;var o=void 0;if(t<0){a=Math.atan(-t)*4;i=new P.V2(e[0],e[1]);o=new P.V2(r[0],r[1])}else{a=Math.atan(t)*4;i=new P.V2(r[0],r[1]);o=new P.V2(e[0],e[1])}var u=o.sub(i);var s=u.length();var c=i.add(u.multiply(.5));var l=Math.abs(s/2/Math.tan(a/2));var f=u.norm();var d=void 0;if(a<Math.PI){var v=new P.V2(f.x*Math.cos(Math.PI/2)-f.y*Math.sin(Math.PI/2),f.y*Math.cos(Math.PI/2)+f.x*Math.sin(Math.PI/2));d=c.add(v.multiply(-l))}else{var y=new P.V2(f.x*Math.cos(Math.PI/2)-f.y*Math.sin(Math.PI/2),f.y*Math.cos(Math.PI/2)+f.x*Math.sin(Math.PI/2));d=c.add(y.multiply(l))}var h=Math.atan2(o.y-d.y,o.x-d.x)/Math.PI*180;var b=Math.atan2(i.y-d.y,i.x-d.x)/Math.PI*180;if(b<h){b+=360}var p=o.sub(d).length();var x=Math.floor(h/n)*n+n;var m=Math.ceil(b/n)*n-n;var k=[];for(var g=x;g<=m;g+=n){k.push(d.add(new P.V2(Math.cos(g/180*Math.PI)*p,Math.sin(g/180*Math.PI)*p)))}if(t<0){k.reverse()}return k.map(function(e){return[e.x,e.y]})}},{vecks:51}],27:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e("../config");var a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}function o(){if(a.default.verbose){console.info.apply(undefined,arguments)}}function u(){if(a.default.verbose){console.warn.apply(undefined,arguments)}}function s(){console.error.apply(undefined,arguments)}t.default={info:o,warn:u,error:s}},{"../config":2}],28:[function(e,r,t){},{}],29:[function(e,r,t){},{}],30:[function(e,r,t){function n(e,r){var t=-1,n=e.length;while(++t<n){if(r(e[t],t,e)===false){break}}return e}r.exports=n},{}],31:[function(e,r,t){},{"lodash._basecopy":35,"lodash.keys":32}],32:[function(e,r,t){var n=e("lodash._getnative");var a=n(Object,"keys");var i=function(e){return a(e)};r.exports=i},{"lodash._getnative":38,"lodash.isarguments":40,"lodash.isarray":41}],33:[function(D,W,e){(function(e){var d=D("lodash._arraycopy"),v=D("lodash._arrayeach"),y=D("lodash._baseassign"),t=D("lodash._basefor"),h=D("lodash.isarray"),n=D("lodash.keys");var b="[object Arguments]",r="[object Array]",o="[object Boolean]",u="[object Date]",a="[object Error]",p="[object Function]",i="[object Map]",s="[object Number]",x="[object Object]",c="[object RegExp]",l="[object Set]",f="[object String]",m="[object WeakMap]";var k="[object ArrayBuffer]",g="[object Float32Array]",P="[object Float64Array]",M="[object Int8Array]",_="[object Int16Array]",E="[object Int32Array]",w="[object Uint8Array]",j="[object Uint8ClampedArray]",T="[object Uint16Array]",O="[object Uint32Array]";var Y=/\w*$/;var B={};B[b]=B[r]=B[k]=B[o]=B[u]=B[g]=B[P]=B[M]=B[_]=B[E]=B[s]=B[x]=B[c]=B[f]=B[w]=B[j]=B[T]=B[O]=true;B[a]=B[p]=B[i]=B[l]=B[m]=false;var I=Object.prototype;var L=I.hasOwnProperty;var S=I.toString;var A=e.ArrayBuffer,N=e.Uint8Array;function C(t,n,a,e,r,i,o){var u;if(a){u=r?a(t,e,r):a(t)}if(u!==undefined){return u}if(!G(t)){return t}var s=h(t);if(s){u=X(t);if(!n){return d(t,u)}}else{var c=S.call(t),l=c==p;if(c==x||c==b||l&&!r){u=z(l?{}:t);if(!n){return y(u,t)}}else{return B[c]?F(t,c,n):r?t:{}}}i||(i=[]);o||(o=[]);var f=i.length;while(f--){if(i[f]==t){return o[f]}}i.push(t);o.push(u);(s?v:R)(t,function(e,r){u[r]=C(e,n,a,r,t,i,o)});return u}function R(e,r){return t(e,r,n)}function V(e){var r=new A(e.byteLength),t=new N(r);t.set(new N(e));return r}function X(e){var r=e.length,t=new e.constructor(r);if(r&&typeof e[0]=="string"&&L.call(e,"index")){t.index=e.index;t.input=e.input}return t}function z(e){var r=e.constructor;if(!(typeof r=="function"&&r instanceof r)){r=Object}return new r}function F(e,r,t){var n=e.constructor;switch(r){case k:return V(e);case o:case u:return new n(+e);case g:case P:case M:case _:case E:case w:case j:case T:case O:var a=e.buffer;return new n(t?V(a):a,e.byteOffset,e.length);case s:case f:return new n(e);case c:var i=new n(e.source,Y.exec(e));i.lastIndex=e.lastIndex}return i}function G(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}W.exports=C}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"lodash._arraycopy":29,"lodash._arrayeach":30,"lodash._baseassign":31,"lodash._basefor":36,"lodash.isarray":41,"lodash.keys":34}],34:[function(e,r,t){arguments[4][32][0].apply(t,arguments)},{dup:32,"lodash._getnative":38,"lodash.isarguments":40,"lodash.isarray":41}],35:[function(e,r,t){},{}],36:[function(e,r,t){var n=a();function a(s){return function(e,r,t){var n=-1,a=Object(e),i=t(e),o=i.length;while(o--){var u=i[s?o:++n];if(r(a[u],u,a)===false){break}}return e}}r.exports=n},{}],37:[function(e,r,t){},{}],38:[function(e,r,t){function n(e,r){var t=e==null?undefined:e[r];return a(t)?t:undefined}function a(e){if(e==null){return false}return true}r.exports=n},{}],39:[function(e,r,t){var n=e("lodash._baseclone"),a=e("lodash._bindcallback");function i(e,r,t){return typeof r=="function"?n(e,true,a(r,t,3)):n(e,true)}r.exports=i},{"lodash._baseclone":33,"lodash._bindcallback":37}],40:[function(e,r,t){},{}],41:[function(e,r,t){var n=a(Array,"isArray");function a(e,r){var t=e==null?undefined:e[r];return o(t)?t:undefined}var i=n;function o(e){if(e==null){return false}return true}r.exports=i},{}],42:[function(e,r,t){function n(){this.shift=["\n"];this.step="  ",maxdeep=100,ix=0;for(ix=0;ix<maxdeep;ix++){this.shift.push(this.shift[ix]+this.step)}}n.prototype.xml=function(e){var r=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/xmlns\:/g,"~::~xmlns:").replace(/xmlns\=/g,"~::~xmlns=").split("~::~"),t=r.length,n=false,a=0,i="",o=0;for(o=0;o<t;o++){if(r[o].search(/<!/)>-1){i+=this.shift[a]+r[o];n=true;if(r[o].search(/-->/)>-1||r[o].search(/\]>/)>-1||r[o].search(/!DOCTYPE/)>-1){n=false}}else if(r[o].search(/-->/)>-1||r[o].search(/\]>/)>-1){i+=r[o];n=false}else if(/^<\w/.exec(r[o-1])&&/^<\/\w/.exec(r[o])&&/^<[\w:\-\.\,]+/.exec(r[o-1])==/^<\/[\w:\-\.\,]+/.exec(r[o])[0].replace("/","")){i+=r[o];if(!n)a--}else if(r[o].search(/<\w/)>-1&&r[o].search(/<\//)==-1&&r[o].search(/\/>/)==-1){i=!n?i+=this.shift[a++]+r[o]:i+=r[o]}else if(r[o].search(/<\w/)>-1&&r[o].search(/<\//)>-1){i=!n?i+=this.shift[a]+r[o]:i+=r[o]}else if(r[o].search(/<\//)>-1){i=!n?i+=this.shift[--a]+r[o]:i+=r[o]}else if(r[o].search(/\/>/)>-1){i=!n?i+=this.shift[a]+r[o]:i+=r[o]}else if(r[o].search(/<\?/)>-1){i+=this.shift[a]+r[o]}else if(r[o].search(/xmlns\:/)>-1||r[o].search(/xmlns\=/)>-1){i+=this.shift[a]+r[o]}else{i+=r[o]}}return i[0]=="\n"?i.slice(1):i};n.prototype.xmlmin=function(e,r){var t=r?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"");return t.replace(/>\s{0,}</g,"><")};t.pd=new n},{}],43:[function(e,r,t){},{"./V2":49}],44:[function(e,r,t){},{}],45:[function(e,r,t){},{"./V2":49}],46:[function(e,r,t){},{"./V3":50}],47:[function(e,r,t){},{}],48:[function(e,r,t){},{"./V3":50}],49:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,r,t){if(r)n(e.prototype,r);if(t)n(e,t);return e}}();function i(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function t(e,r){i(this,t);if((typeof e==="undefined"?"undefined":n(e))==="object"){this.x=e.x;this.y=e.y}else{this.x=e;this.y=r}}a(t,[{key:"equals",value:function e(r){return this.x===r.x&&this.y===r.y}},{key:"length",value:function e(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function e(){return new t(-this.x,-this.y)}},{key:"add",value:function e(r){return new t(this.x+r.x,this.y+r.y)}},{key:"sub",value:function e(r){return new t(this.x-r.x,this.y-r.y)}},{key:"multiply",value:function e(r){return new t(this.x*r,this.y*r)}},{key:"norm",value:function e(){return this.multiply(1/this.length())}},{key:"dot",value:function e(r){return this.x*r.x+this.y*r.y}}]);return t}();t.default=o},{}],50:[function(e,r,t){},{}],51:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Line3=t.Line2=t.Quaternion=t.Plane3=t.Box3=t.Box2=t.V3=t.V2=undefined;var n=e("./V2");var a=m(n);var i=e("./V3");var o=m(i);var u=e("./Box2");var s=m(u);var c=e("./Box3");var l=m(c);var f=e("./Plane3");var d=m(f);var v=e("./Quaternion");var y=m(v);var h=e("./Line2");var b=m(h);var p=e("./Line3");var x=m(p);function m(e){return e&&e.__esModule?e:{default:e}}t.V2=a.default;t.V3=o.default;t.Box2=s.default;t.Box3=l.default;t.Plane3=d.default;t.Quaternion=y.default;t.Line2=b.default;t.Line3=x.default},{"./Box2":43,"./Box3":44,"./Line2":45,"./Line3":46,"./Plane3":47,"./Quaternion":48,"./V2":49,"./V3":50}]},{},[23])(23)});